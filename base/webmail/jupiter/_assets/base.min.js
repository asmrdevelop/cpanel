!function(){"use strict";function a(a){$("span[data-default-webmail-app]").each((function(){var t=$(this);t.attr("data-default-webmail-app")===a?t.removeClass("far fa-spinner fa-spin").addClass("fas fa-star"):t.removeClass("fas fa-spinner fa-spin").addClass("far fa-star")}))}function t(t){var i;t&&(window.NVData.default_webmail_app=NVData.default_webmail_app,i=NVData.default_webmail_app,$.isFunction(a)&&a(i),$.isFunction(e)&&e())}function e(){$("#mailClientList .panel").each((function(){$(this).attr("data-default-webmail-app")===NVData.default_webmail_app?($(this).removeClass("panel-default").addClass("panel-primary"),$(this).children("a.mail-client-action-link").removeClass("show").addClass("hide"),$(this).find(".default-mail-client").removeClass("hide").addClass("show")):($(this).removeClass("panel-primary").addClass("panel-default"),$(this).children("a.mail-client-action-link").removeClass("hide").addClass("show"),$(this).find(".default-mail-client").removeClass("show").addClass("hide"))}))}function i(){window.location=window.NVData.mail_clients[window.NVData.active_webmail_app].url}function n(a){var t=window.NVData.mail_clients;a&&t&&t.hasOwnProperty(a)||(a=l());var e=document.getElementById("setAsActive-"+window.NVData.active_webmail_app);if(e&&(e.classList.add("disabled"),e.setAttribute("aria-disabled","true"),e.setAttribute("tabindex","-1")),window.NVData.active_webmail_app!==a){window.NVData.active_webmail_app=a;var i=document.getElementById("setAsActive-"+a);i&&(i.classList.add("disabled"),i.setAttribute("tabindex","-1"),i.setAttribute("aria-disabled","true"),e&&(e.classList.remove("disabled"),e.setAttribute("aria-disabled","false"),e.setAttribute("tabindex","0")))}var n=document.getElementById("activeClientLogoContainer");if(n){var d=document.getElementById("activeClientLogo"),s=document.createElement("img");s.src=t[a].icon,s.id="activeClientLogo",s.alt=LOCALE.maketext("Your currently active mail client is “[_1]”.",a),s.setAttribute("aria-hidden","true"),d?n.replaceChild(s,d):n.appendChild(s),document.getElementById("setActiveAsDefault").checked=a===window.NVData.default_webmail_app}}function l(){var a=window.NVData.default_webmail_app,t=window.NVData.mail_clients.hasOwnProperty("roundcube");return a&&window.NVData.mail_clients.hasOwnProperty(a)?a:t?"roundcube":Object.keys(window.NVData.mail_clients)[0]}$((function(){var e=l(),d=window.NVData.default_webmail_app;window.NVData.active_webmail_app=e,d&&a(d),n(e),$("a.app-fav").click((function(e){var i=$(this).attr("data-default-webmail-app");!function(a){$("span[data-default-webmail-app="+a+"]").removeClass("far fa-star").addClass("fas fa-spinner fa-spin")}(i),function(e){e&&e.length>0&&(window.NVData.default_webmail_app!==e?SetNvData("default_webmail_app",e,t):a(e))}(i),e.stopPropagation()})),$("a.mail-client-action-link").click((function(){var a=$(this).attr("data-default-webmail-app");SetNvData("default_webmail_app",a,t)}));var s=document.getElementById("setActiveAsDefault"),c=document.getElementById("launchActiveButton"),o=document.getElementById("activeClientLogoContainer"),r=window.NVData.mail_clients;r&&(Object.keys(window.NVData.mail_clients).forEach((function(a){var t=document.getElementById("setAsActive-"+a);t&&t.addEventListener("click",(function(t){t.target.matches("img.availableClientDock")&&t.target.parentElement.classList.contains("disabled")||n(a)}),!1)})),s&&e===window.NVData.default_webmail_app&&r.hasOwnProperty(window.NVData.active_webmail_app)&&(s.checked=!0)),s&&s.addEventListener("click",(function(a){SetNvData("default_webmail_app",s.checked?window.NVData.active_webmail_app:"",t)})),c&&c.addEventListener("click",i),o&&(o.addEventListener("click",i),o.focus())}))}();