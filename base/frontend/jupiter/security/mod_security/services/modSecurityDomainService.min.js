define(["angular","lodash","cjt/util/locale","cjt/io/api","cjt/io/uapi-request","cjt/io/uapi","cjt/services/APIService"],(function(e,t,r,a,i,n){e.module("App").factory("modSecurityDomainService",["$q","APIService",function(r,a){function n(e){var r=[];if(e.data){for(var a=e.data,i=0,n=a.length;i<n;i++)r.push(a[i]);var o=e.meta,s=o.paginate.total_records||a.length,l=o.paginate.total_pages||1,d=0,c=0;if(o.hasOwnProperty("modsec"))d=o.modsec.total_enabled,c=o.modsec.total_disabled;else{var u=t.filter(a,(function(e){return!!e.enabled}));d=u?u.length:0,c=a.length-d}return{items:r,totalItems:s,totalPages:l,totalEnabled:d,totalDisabled:c}}return{items:[],totalItems:0,totalPages:0,totalEnabled:0,totalDisabled:0}}function o(e,t){var r=new i.Class;return r.initialize("ModSecurity",e,{domains:t}),this.deferred(r,{done:function(e,t){var r=n(e=e.parsedResponse);e.status?t.resolve(r):t.reject({items:r.items,error:e.error})}}).promise}function s(e){var t=new i.Class;return t.initialize("ModSecurity",e),this.deferred(t,{done:function(e,t){var r=n(e=e.parsedResponse);e.status?t.resolve(r):(r.error=e.error,t.reject(r))}}).promise}var l=function(){};return l.prototype=new a,e.extend(l.prototype,{fetchList:function(e){var t=new i.Class;return t.initialize("ModSecurity","list_domains"),e&&(e.sortBy&&e.sortDirection&&t.addSorting(e.sortBy,e.sortDirection,e.sortType),e.pageNumber&&t.addPaging(e.pageNumber,e.pageSize||10),e.filterBy&&e.filterCompare&&e.filterValue&&t.addFilter(e.filterBy,e.filterCompare,e.filterValue)),this.deferred(t,{transformAPISuccess:n}).promise},prepareList:function(e){return n(e)},enableDomains:function(e){return o.call(this,"enable_domains",e)},enableAllDomains:function(){return s.call(this,"enable_all_domains")},disableDomains:function(e){return o.call(this,"disable_domains",e)},disableAllDomains:function(){return s.call(this,"disable_all_domains")}}),new l}])}));