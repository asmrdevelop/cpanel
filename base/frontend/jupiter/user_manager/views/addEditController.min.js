define(["angular","lodash","cjt/util/locale","cjt/validator/email-validator","cjt/directives/validationItemDirective","cjt/directives/validationContainerDirective","cjt/directives/validateEqualsDirective","cjt/directives/passwordFieldDirective","cjt/directives/actionButtonDirective","app/directives/validateUsernameWithDomain","app/directives/emailServiceConfig","app/directives/ftpServiceConfig","app/directives/webdiskServiceConfig","uiBootstrap"],(function(e,i,a){var r=e.module("App");return function(t,s,n,o,d,c,u,m,v){return{initializeScope:function(){t.ui={docrootByDomain:PAGE.docrootByDomain,domainList:Object.keys(PAGE.docrootByDomain),user:s.emptyUser()},t.isOverQuota=!m.under_quota_overall,t.ui.user.domain=PAGE.primaryDomain,t.ui.user.services.ftp.homedir=PAGE.docrootByDomain[PAGE.primaryDomain]+"/",t.ui.user.services.webdisk.homedir=PAGE.docrootByDomain[PAGE.primaryDomain]+"/",t.inProgress=!1,t.minimumPasswordStrength=e.isDefined(PAGE.minimumPasswordStrength)?parseInt(PAGE.minimumPasswordStrength,10):10,t.emailDaemon=n,t.ftpDaemon=o,t.webdiskDaemon=d,t.features=c,t.defaults=u,t.quotaInfo=m,t.useCandidateServices=this.useCandidateServices,t.insertSubAndRemoveDupes=this.insertSubAndRemoveDupes},initializeView:function(){v.clear(),this.showCpanelOverQuotaWarning()},clearPrefetch:function(){r.firstLoad.userList=!1},useCandidateServices:function(e,i){s.integrateCandidateServices(e,i)},insertSubAndRemoveDupes:function(a,r){var t=i.sortedIndexBy(r,a,"full_username"),n=[];e.forEach(a.services,(function(e,i){e.enabled&&n.push(i)})),a.dismissed_merge_candidates&&a.dismissed_merge_candidates.forEach((function(e){n.push(e.service)}));for(var o,d,c,u=t;r[u]&&r[u].full_username===a.full_username;){if("service"!==(d=r[u]).type)o=!0;else for(var m=0,v=n.length;m<v;m++)if(c=n[m],d.services[c].enabled){o=!0;break}o?r.splice(u,1):u++}var l=s.expandDismissed(a);r.splice.apply(r,[t,0].concat(l))},showCpanelOverQuotaWarning:function(){t.isOverQuota&&v.add({message:a.maketext("Your [asis,cPanel] account exceeds its disk quota. You cannot add or edit users."),type:"danger",id:"over-quota-warning",replace:!1,counter:!1})}}}}));