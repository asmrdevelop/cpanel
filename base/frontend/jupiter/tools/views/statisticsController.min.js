define(["lodash","angular","cjt/util/locale","app/services/statisticsService","cjt/directives/spinnerDirective","cjt/decorators/growlDecorator","cjt/decorators/growlAPIReporter"],(function(t,e,r){"use strict";var i={format_bytes:!0,format_bytes_per_second:!0};return e.module("App").controller("statisticsController",["$scope","spinnerAPI","statisticsService","growl","$timeout",function(e,n,a,s,o){n.start("loadingStatsSpinner"),o((function(){a.fetchExtendedStats().then((function(n){e.statistics=function(e){for(var n=0;n<e.length;n++){var a=e[n],s=!!i[a.formatter],o=s?r.format_bytes(a.usage):r.numf(a.usage),c=null;"format_bytes_per_second"===a.formatter?(o+="/s",a.isLimited&&(c=r.format_bytes(a.maximum)+"/s")):c=a.isLimited?s?r.format_bytes(a.maximum):r.numf(a.maximum):"âˆž";var m=null;a.showWarning&&(m=a.percent>=100?r.maketext("[_1] limit exceeded.",a.description):r.maketext("[_1] is nearing its limit.",a.description)),t.assign(a,{showPercent:!(!a.isLimited||!a.maximum),formattedPercent:r.numf(a.percent),formattedMaximum:c,formattedUsage:o,warningTooltip:m})}return e}(n)})).finally((function(){n.stop("loadingStatsSpinner")}))})),e.appUpgradeUrl=PAGE.appUpgradeUrl&&(PAGE.dprefix||"")+PAGE.appUpgradeUrl,e.getStatStatus=function(t,e){return e?"warning":t>=80?"danger":t>=60?"warning":t>=40?"info":t>=0?"success":void 0},e.glassGetStatStatus=function(t){return t>=100?"danger":t>=80?"warning":void 0}}])}));