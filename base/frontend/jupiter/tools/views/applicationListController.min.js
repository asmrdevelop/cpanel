define(["angular","lodash","cjt/util/locale","cjt/services/cpanel/nvDataService","app/directives/draggableDirective","app/directives/dropDirective"],(function(e,r,t){"use strict";return e.module("App").controller("applicationListController",["$scope","nvDataService",function(t,n){var a=PAGE.appGroups,o=PAGE.collapsedGroups.split("|");t.collapsedGroups=PAGE.collapsedGroups;var c,i,l=document.querySelector("#quickjump");l&&t.searchText!==l.value&&(t.searchText=l.value),c="#boxes [id*='-container'] > [id*='-group'] > [id*='-body'] > .icon-container-body > a",(i=document.querySelectorAll(c))&&i.length&&window.mixpanel&&window.mixpanel.track_links(i,"cPanel-Tools-Nav-Link",(e=>({"nav-link-id":e.id}))),t.clearSearch=function(e){27===e.keyCode&&(t.searchText="")};var s={};t.searchGroup=function(e){if(!t.searchText)return 1;s[t.searchText]||(s[t.searchText]=new RegExp(t.searchText,"i"));for(var n=s[t.searchText],o=!1,c=r.find(a,(function(r){return r.group===e})),i=c.length?c.items:[],l=0,u=i.length;l<u;l++)if(o=n.test(i[l].searchtext))return o},t.searchItem=function(e){return t.searchText?(s[t.searchText]||(s[t.searchText]=new RegExp(t.searchText,"i")),s[t.searchText].test(e.searchtext)):1};t.toggleGroup=function(r){var a=e.element(document.querySelector("#"+r+"-body")),c=e.element(document.querySelector("#"+r+"-collapsed-indicator"));r+="=0";var i=o.indexOf(r);-1===i?(a.removeClass("maximize"),o.push(r),a.addClass("minimized ng-hide"),c.removeClass("fa-minus"),c.addClass("fa-plus")):(a.removeClass("minimized ng-hide"),o.splice(i,1),a.addClass("maximize"),c.removeClass("fa-plus"),c.addClass("fa-minus"));var l,s=o.join("|");t.collapsedGroups=s,l=s,n.setObject({xmainrollstatus:l}).catch((function(e){console.error(e)}))},t.handleDrag=function(t){var n=t.replace("-group","");e.element(document.querySelector("#"+n+"-body")).removeClass("minimize maximize");var o=r.findIndex(a,(function(e){return e.group===n})),c="#top-drop-area";o>0&&(c="#"+a[o-1].group+"-drop-area"),e.element(document.querySelector(c)).addClass("drag-hidden")},t.handleDragEnd=function(){e.element(document.querySelectorAll(".drag-hidden")).removeClass("drag-hidden")},t.handleDrop=function(e,t){var o,c,i=e.getAttribute("data-group-name"),l=t.getAttribute("data-group-name"),s=document.querySelector("#boxes");l?(o=document.querySelector("#"+i+"-container"),c=document.querySelector("#"+l+"-container")):(o=document.querySelector("#"+i+"-container"),c=document.querySelector("#top-drop-area")),s&&o&&c&&s.insertBefore(o,c.nextSibling);var u=r.findIndex(a,(function(r){return r.group===e.id.replace("-group","")})),d=a[u],p=r.findIndex(a,(function(e){return e.group===t.id.replace("-drop-area","")}));u>p&&(p+=1),a.splice(u,1),a.splice(p,0,d);var m,h=r.map(a,"group").join("|");m=h,n.setObject({xmaingroupsorder:m}).catch((function(e){console.error(e)}))}}])}));