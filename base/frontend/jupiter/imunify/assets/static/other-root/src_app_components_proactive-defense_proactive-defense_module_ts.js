"use strict";(self["webpackJsonpother-root"]=self["webpackJsonpother-root"]||[]).push([["src_app_components_proactive-defense_proactive-defense_module_ts"],{56490:(e,t,n)=>{n.r(t),n.d(t,{ProactiveDefenseModule:()=>nt});var i=n(71670),a=n(34929),r=n(53850),o=n(91792),l=n(15815),d=n(92013),s=n(39153),p=n(33389),c=n(16141),m=n(47953),u=n(66826),f=n(73842),v=n(72986),h=n(4884),g=n(64650);let x=(()=>{class e{constructor(e){this.xhr=e,this._ignoreList=this.xhr.rx(h.nD.ignoreList),this.ignoreList=this.xhr.wrap(this._ignoreList,h.be),this.ignoreAdd=this.xhr.rx(h.nD.ignoreAdd),this.ignoreDeletePaths=this.xhr.rx(h.nD.ignoreDeletePaths),this.ignoreDeleteRule=this.xhr.rx(h.nD.ignoreDeleteRule),this._list=this.xhr.rx(h.nD.list),this.list=this.xhr.wrap(this._list,h.op),this._details=this.xhr.rx(h.nD.details)}details(e){return this._details(e).pipe((0,o.map)((e=>new h.s4(e.data.items))))}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275inject"](g.K))},e.\u0275prov=r["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();var y=n(63326),I=n(60136),b=n(25355),S=n(45454),w=n(39492),C=n(29639),E=n(45837),M=n(5081),_=n(38699),k=n(47883),P=n(17602),O=n(25684);function F(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div",21),r["\u0275\u0275text"](1),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",e.data.description," ")}}function R(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"button",22),r["\u0275\u0275listener"]("click",(function(){r["\u0275\u0275restoreView"](e);const t=r["\u0275\u0275nextContext"]();return r["\u0275\u0275resetView"](t.addToIgnore(!0))})),r["\u0275\u0275text"](1),r["\u0275\u0275pipe"](2,"translate"),r["\u0275\u0275elementEnd"]()}2&e&&(r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](2,1,"pd.details.ignore.detected")," "))}function D(e,t){if(1&e&&(r["\u0275\u0275elementContainerStart"](0),r["\u0275\u0275text"](1),r["\u0275\u0275elementContainerEnd"]()),2&e){const e=r["\u0275\u0275nextContext"](2);r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" (",e.data.country,") ")}}function L(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"button",30),r["\u0275\u0275listener"]("click",(function(){r["\u0275\u0275restoreView"](e);const t=r["\u0275\u0275nextContext"](3);return r["\u0275\u0275resetView"](t.addToBlackList())})),r["\u0275\u0275text"](1),r["\u0275\u0275pipe"](2,"translate"),r["\u0275\u0275elementEnd"]()}2&e&&(r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](2,1,"pd.details.blockIp")," "))}function T(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div",28),r["\u0275\u0275template"](1,L,3,3,"button",29),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"](2);r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",e.data.purpose!==e.IPList.black&&e.data.purpose!==e.IPList.drop)}}function A(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div",9)(1,"div",10),r["\u0275\u0275text"](2,"pd.details.titles.ip"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](3,"div",23)(4,"i360-colored-ip",24),r["\u0275\u0275text"](5),r["\u0275\u0275template"](6,D,2,1,"ng-container",25),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](7,"div",26),r["\u0275\u0275text"](8,"pd.details.onlyOne"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](9,T,2,1,"div",27),r["\u0275\u0275pipe"](10,"async"),r["\u0275\u0275elementEnd"]()()),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275advance"](4),r["\u0275\u0275property"]("listName",e.data.purpose),r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",e.data.ip," "),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",e.data.country),r["\u0275\u0275advance"](3),r["\u0275\u0275property"]("ngIf",r["\u0275\u0275pipeBind1"](10,4,e.authState.isAdmin))}}function j(e,t){if(1&e&&r["\u0275\u0275text"](0),2&e){const e=t.$implicit;r["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function B(e,t){if(1&e&&r["\u0275\u0275text"](0),2&e){const e=t.$implicit;r["\u0275\u0275textInterpolate1"](" ",e.value," ")}}class V extends m.j{constructor(e,t,n,i,a,r){super(),this.data=e,this.modalService=t,this.authState=n,this.proactiveDefenseService=i,this.eventsComponent=a,this.listsService=r,this.IPList=c._T,this.loaded=new o.BehaviorSubject([]),this.loaded.next(e.env)}addToBlackList(){var e=this;return(0,i.Z)((function*(){(yield e.listsService.changeListWithConfirm([e.data.ip],e.data.listname,c._T.black))&&(e.data.listname=c._T.black)}))()}addToIgnore(e=!1){var t=this;return(0,i.Z)((function*(){yield t.eventsComponent.addToIgnore([t.data],e)}))()}viewFile(){var e=this;return(0,i.Z)((function*(){yield e.modalService.openFileViewer(e.data.path)}))()}}function N(e,t){if(1&e&&(r["\u0275\u0275elementContainerStart"](0),r["\u0275\u0275elementStart"](1,"strong"),r["\u0275\u0275text"](2),r["\u0275\u0275pipe"](3,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](4),r["\u0275\u0275elementContainerEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]().$implicit;r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](3,2,"pd.addToIgnoreModal.rules")),r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate1"](" ",e.rules," ")}}function $(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"p",4)(1,"strong"),r["\u0275\u0275text"](2),r["\u0275\u0275pipe"](3,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](4),r["\u0275\u0275element"](5,"br"),r["\u0275\u0275template"](6,N,5,4,"ng-container",5),r["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](3,3,"pd.addToIgnoreModal.path")),r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate1"](" ",e.path,""),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngIf",e.rules)}}V.\u0275fac=function(e){return new(e||V)(r["\u0275\u0275directiveInject"](p.MAT_DIALOG_DATA),r["\u0275\u0275directiveInject"](f.Z),r["\u0275\u0275directiveInject"](v.j),r["\u0275\u0275directiveInject"](x),r["\u0275\u0275directiveInject"]((0,r.forwardRef)((()=>me))),r["\u0275\u0275directiveInject"](y.$,8))},V.\u0275cmp=r["\u0275\u0275defineComponent"]({type:V,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&r["\u0275\u0275viewQuery"](l.e,7),2&e){let e;r["\u0275\u0275queryRefresh"](e=r["\u0275\u0275loadQuery"]())&&(t.loader=e.first)}},features:[r["\u0275\u0275ProvidersFeature"]([{provide:u.g,useExisting:V}]),r["\u0275\u0275InheritDefinitionFeature"]],decls:52,vars:23,consts:[[3,"showConfirm","showCancel"],["modal-title",""],["modal-body",""],["i360-description","","class","main-description",4,"ngIf"],["mat-raised-button","","id","details-ignore-detected","color","",3,"click",4,"ngIf"],["mat-raised-button","","id","details-ignore-all","color","",3,"click"],["mat-raised-button","","id","details-view-file",3,"click"],["i360Loader","",1,"details-data"],[1,"details-data-column"],[1,"details-data-item"],["translate","",1,"details-data-title"],["id","details-url",1,"details-data-value","rtl-except"],["class","details-data-item",4,"ngIf"],["id","details-number-of-times",1,"details-data-value"],["id","details-time",1,"details-data-value"],["id","details-action",1,"details-data-value"],["id","details-script-path",1,"details-data-value","rtl-except"],[1,"fixedLayout"],["headerText","pd.details.headers.name"],["i360HostTemplate",""],["headerText","pd.details.headers.value"],["i360-description","",1,"main-description"],["mat-raised-button","","id","details-ignore-detected","color","",3,"click"],[1,"details-data-value"],[3,"listName"],[4,"ngIf"],["i360-description","","translate",""],["class","flexer flex-nowrap",4,"ngIf"],[1,"flexer","flex-nowrap"],["mat-button","","id","details-add-to-black",3,"click",4,"ngIf"],["mat-button","","id","details-add-to-black",3,"click"]],template:function(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"i360-modal-content",0),r["\u0275\u0275elementContainerStart"](1,1),r["\u0275\u0275text"](2),r["\u0275\u0275elementContainerEnd"](),r["\u0275\u0275elementStart"](3,"div",2),r["\u0275\u0275template"](4,F,2,1,"div",3),r["\u0275\u0275elementStart"](5,"div"),r["\u0275\u0275template"](6,R,3,3,"button",4),r["\u0275\u0275elementStart"](7,"button",5),r["\u0275\u0275listener"]("click",(function(){return t.addToIgnore()})),r["\u0275\u0275text"](8),r["\u0275\u0275pipe"](9,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](10,"button",6),r["\u0275\u0275listener"]("click",(function(){return t.viewFile()})),r["\u0275\u0275text"](11),r["\u0275\u0275pipe"](12,"translate"),r["\u0275\u0275elementEnd"]()(),r["\u0275\u0275elementStart"](13,"div",7)(14,"div",8)(15,"div",9)(16,"div",10),r["\u0275\u0275text"](17,"pd.details.titles.url"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](18,"div",11),r["\u0275\u0275text"](19),r["\u0275\u0275elementEnd"]()(),r["\u0275\u0275template"](20,A,11,6,"div",12),r["\u0275\u0275elementStart"](21,"div",9)(22,"div",10),r["\u0275\u0275text"](23,"pd.details.titles.numberOfTimes"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](24,"div",13),r["\u0275\u0275text"](25),r["\u0275\u0275elementEnd"]()()(),r["\u0275\u0275elementStart"](26,"div",8)(27,"div",9)(28,"div",10),r["\u0275\u0275text"](29,"pd.details.titles.time"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](30,"div",14),r["\u0275\u0275text"](31),r["\u0275\u0275pipe"](32,"date"),r["\u0275\u0275elementEnd"]()(),r["\u0275\u0275elementStart"](33,"div",9)(34,"div",10),r["\u0275\u0275text"](35,"pd.details.titles.action"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](36,"div",15),r["\u0275\u0275text"](37),r["\u0275\u0275elementEnd"]()(),r["\u0275\u0275elementStart"](38,"div",9)(39,"div",10),r["\u0275\u0275text"](40,"pd.details.titles.scriptPath"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](41,"div",16),r["\u0275\u0275text"](42),r["\u0275\u0275elementEnd"]()()()(),r["\u0275\u0275elementStart"](43,"div")(44,"i360-header"),r["\u0275\u0275text"](45),r["\u0275\u0275pipe"](46,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](47,"i360-table",17)(48,"i360-column",18),r["\u0275\u0275template"](49,j,1,1,"ng-template",19),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](50,"i360-column",20),r["\u0275\u0275template"](51,B,1,1,"ng-template",19),r["\u0275\u0275elementEnd"]()()()()()),2&e&&(r["\u0275\u0275property"]("showConfirm",!1)("showCancel",!1),r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate1"](" ",t.data.rule_name," "),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngIf",t.data.description),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngIf",null!==t.data.rule_id),r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](9,14,"pd.details.ignore.all")," "),r["\u0275\u0275advance"](3),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](12,16,"pd.details.viewFileContent")," "),r["\u0275\u0275advance"](8),r["\u0275\u0275textInterpolate"](t.data.url),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",t.data.ip),r["\u0275\u0275advance"](5),r["\u0275\u0275textInterpolate1"](" ",t.data.count," "),r["\u0275\u0275advance"](6),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind2"](32,18,1e3*t.data.timestamp,"dd-MM-yyyy HH:mm a")," "),r["\u0275\u0275advance"](6),r["\u0275\u0275textInterpolate1"](" ",t.data.action," "),r["\u0275\u0275advance"](5),r["\u0275\u0275textInterpolate1"](" ",t.data.path," "),r["\u0275\u0275advance"](3),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](46,21,"pd.details.environment")," "))},dependencies:[I.NgIf,l.e,b.a,S.b,w.PS,C.w,E.F,M.E,_.Pi,k.t,P.MatButton,O.w,I.AsyncPipe,I.DatePipe,_.X$],styles:[".i360-app .i360-pro-active-details-panel {\n  width: 930px !important;\n  max-height: 100%;\n}\n.i360-app .i360-pro-active-details-panel i360-loader {\n  z-index: 1051;\n}\n.i360-app .i360-pro-active-details-panel .main-description {\n  margin-bottom: 25px;\n}\n.i360-app .i360-pro-active-details-panel .mat-dialog-title {\n  margin-bottom: 5px;\n}\n.ltr .i360-app .i360-pro-active-details-panel .mat-raised-button {\n  margin-right: 12px;\n}\n.rtl .i360-app .i360-pro-active-details-panel .mat-raised-button {\n  margin-left: 12px;\n}\n.i360-app .i360-pro-active-details-panel .details-data {\n  margin-top: 38px;\n  margin-bottom: 19px;\n  display: flex;\n}\n@media (min-width: 800px) {\n  .i360-app .i360-pro-active-details-panel .details-data {\n    flex-direction: row;\n  }\n}\n@media (max-width: 800px) {\n  .i360-app .i360-pro-active-details-panel .details-data {\n    flex-direction: column;\n  }\n}\n.ltr .i360-app .i360-pro-active-details-panel .details-data .details-data-column {\n  padding-right: 10px;\n}\n.rtl .i360-app .i360-pro-active-details-panel .details-data .details-data-column {\n  padding-left: 10px;\n}\n.i360-app .i360-pro-active-details-panel .details-data .details-data-column .details-data-item {\n  display: flex;\n  flex-wrap: nowrap;\n  padding-bottom: 21px;\n}\n.i360-app .i360-pro-active-details-panel .details-data .details-data-column .details-data-item .details-data-title {\n  font-weight: bold;\n  display: inline-block;\n  min-width: 100px;\n}\n.i360-app .i360-pro-active-details-panel .details-data .details-data-column .details-data-item .details-data-value {\n  display: inline-block;\n  word-break: break-all;\n}"],encapsulation:2}),(0,a.gn)([d.U],V.prototype,"addToBlackList",null),(0,a.gn)([d.U],V.prototype,"addToIgnore",null),(0,a.gn)([d.U],V.prototype,"viewFile",null);let q=(()=>{class e extends m.j{constructor(e){if(super(),this.data=e,this.groupedItems=[],this.title=e.detectedOnly?"pd.addToIgnoreModal.title.detectedOnly":"pd.addToIgnoreModal.title.all",e.detectedOnly){const t={};let n={};for(let i of e.items)n[i.path]||(n[i.path]=new Set),n[i.path].add(i.rule_id),t[i.rule_id]=i.rule_name;for(let[e,i]of Object.entries(n))this.groupedItems.push({path:e,rules:Array.from(i).map((e=>t[e])).join(", ")})}else{const t=new Set(e.items.map((e=>e.path)));this.groupedItems=Array.from(t).map((e=>({path:e})))}}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](p.MAT_DIALOG_DATA))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[r["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:4,consts:[["confirmText","pd.addToIgnoreModal.confirm","id","ignore-confirm-modal"],["modal-title",""],["modal-body",""],["class","rtl-except break-word",4,"ngFor","ngForOf"],[1,"rtl-except","break-word"],[4,"ngIf"]],template:function(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"i360-modal-content",0),r["\u0275\u0275elementContainerStart"](1,1),r["\u0275\u0275text"](2),r["\u0275\u0275pipe"](3,"translate"),r["\u0275\u0275elementContainerEnd"](),r["\u0275\u0275elementContainerStart"](4,2),r["\u0275\u0275template"](5,$,7,5,"p",3),r["\u0275\u0275elementContainerEnd"](),r["\u0275\u0275elementEnd"]()),2&e&&(r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](3,2,t.title)),r["\u0275\u0275advance"](3),r["\u0275\u0275property"]("ngForOf",t.groupedItems))},dependencies:[I.NgForOf,I.NgIf,M.E,_.X$],encapsulation:2}),e})();var H=n(92962),U=n(41380),Q=n(99894),Z=n(38885),G=n(33601),X=n(15910),W=n(35837),J=n(63934),K=n(43237),z=n(36804),Y=n(55127),ee=n(70424),te=n(93544),ne=n(77144),ie=n(22949);function ae(e,t){if(1&e&&r["\u0275\u0275element"](0,"clock",26),2&e){const e=t.$implicit;r["\u0275\u0275property"]("timestamp",e.timestamp)}}function re(e,t){if(1&e&&r["\u0275\u0275text"](0),2&e){const e=t.$implicit;r["\u0275\u0275textInterpolate1"](" ",e.rule_name," ")}}function oe(e,t){if(1&e&&(r["\u0275\u0275text"](0),r["\u0275\u0275elementStart"](1,"div",27),r["\u0275\u0275text"](2),r["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;r["\u0275\u0275textInterpolate1"](" ",e.path," "),r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate"](e.count)}}function le(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"i360-colored-ip",29),r["\u0275\u0275text"](1),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]().$implicit;r["\u0275\u0275property"]("listName",e.purpose),r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",e.ip," ")}}function de(e,t){if(1&e&&(r["\u0275\u0275elementContainerStart"](0),r["\u0275\u0275template"](1,le,2,2,"i360-colored-ip",28),r["\u0275\u0275elementContainerEnd"]()),2&e){const e=t.$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("ngIf",e.ip)}}function se(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"div",30),r["\u0275\u0275element"](1,"div"),r["\u0275\u0275pipe"](2,"lowercase"),r["\u0275\u0275text"](3),r["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;r["\u0275\u0275advance"](1),r["\u0275\u0275classMapInterpolate1"]("severity-icon ",r["\u0275\u0275pipeBind1"](2,4,e.action),""),r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate1"](" ",e.action," ")}}const pe=function(){return{rule_id:null,NEGATE:!0}},ce=function(){return["timestamp-"]};class me{constructor(e,t,n,i){this.proactiveDefenseService=e,this.modalService=t,this.notifications=n,this.viewContainerRef=i,this.destroyed=new o.Subject}showDetails(e){var t=this;return(0,i.Z)((function*(){yield(0,o.firstValueFrom)(t.proactiveDefenseService.details(e).pipe((0,o.switchMap)((e=>t.modalService.open(V,{data:e,panelClass:"i360-pro-active-details-panel",viewContainerRef:t.viewContainerRef}))),(0,o.switchMap)((()=>t.request.load())),(0,o.takeUntil)(t.destroyed)),{defaultValue:void 0})}))()}ngOnDestroy(){this.destroyed.next()}addToIgnore(e,t=!1){var n=this;return(0,i.Z)((function*(){(yield n.modalService.open(q,{data:{detectedOnly:t,items:e}}))&&(e=e.map((({path:e,rule_id:n,rule_name:i})=>({path:e,...t?{rule_id:n,rule_name:i}:{}}))),yield(0,o.firstValueFrom)(n.proactiveDefenseService.ignoreAdd({items:e}).pipe((0,o.tap)((()=>{n.notifications.success("pd.events.notifications.successfullyAddedToIgnore",null,{count:e.length})}))),{defaultValue:void 0}))}))()}viewFile(e){var t=this;return(0,i.Z)((function*(){yield t.modalService.openFileViewer(e.path)}))()}}me.\u0275fac=function(e){return new(e||me)(r["\u0275\u0275directiveInject"](x),r["\u0275\u0275directiveInject"](f.Z),r["\u0275\u0275directiveInject"](H.T),r["\u0275\u0275directiveInject"](r.ViewContainerRef))},me.\u0275cmp=r["\u0275\u0275defineComponent"]({type:me,selectors:[["i360-proactive-defense-events"]],viewQuery:function(e,t){if(1&e&&(r["\u0275\u0275viewQuery"](l.e,7),r["\u0275\u0275viewQuery"](s.v,7)),2&e){let e;r["\u0275\u0275queryRefresh"](e=r["\u0275\u0275loadQuery"]())&&(t.loader=e.first),r["\u0275\u0275queryRefresh"](e=r["\u0275\u0275loadQuery"]())&&(t.request=e.first)}},decls:45,vars:26,consts:[[3,"i360-request"],["icon","visibility_off","title","pd.events.groupActions.ignoreDetected",3,"filter","perform"],["icon","ignore-all","title","pd.events.groupActions.ignoreAll",3,"perform"],["i360-timeframe",""],["i360-search",""],["i360-paginator","",3,"simplePagination"],["i360-limit",""],["i360-main-view","","i360-sortable","",3,"defaultValue"],["labelField","path"],["field","timestamp","startWith","-"],[3,"timestamp",4,"i360HostTemplate"],["field","rule_name"],["i360HostTemplate",""],["classes","rtl-except"],["field","path"],["bodyField","host"],["field","host"],["field","ip"],[4,"i360HostTemplate"],["field","action"],["class","text-nowrap",4,"i360HostTemplate"],["title","pd.events.actions.viewDetails","icon","remove_red_eye",3,"perform"],["i360-group-actions",""],["title","pd.events.actions.viewFileContent",3,"perform"],["title","pd.events.actions.ignoreDetected",3,"filter","perform"],["title","pd.events.actions.ignoreAll",3,"perform"],[3,"timestamp"],[1,"tries-count"],[3,"listName",4,"ngIf"],[3,"listName"],[1,"text-nowrap"]],template:function(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"div")(1,"i360-data-view",0)(2,"i360-action",1),r["\u0275\u0275listener"]("perform",(function(e){return t.addToIgnore(e,!0)})),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](3,"i360-action",2),r["\u0275\u0275listener"]("perform",(function(e){return t.addToIgnore(e)})),r["\u0275\u0275elementEnd"](),r["\u0275\u0275element"](4,"i360-widget",3)(5,"i360-widget",4)(6,"i360-widget",5)(7,"i360-widget",6),r["\u0275\u0275elementStart"](8,"i360-table",7),r["\u0275\u0275element"](9,"i360-checkbox-column",8),r["\u0275\u0275elementStart"](10,"i360-column")(11,"i360-sort-header",9),r["\u0275\u0275text"](12),r["\u0275\u0275pipe"](13,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](14,ae,1,1,"clock",10),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](15,"i360-column")(16,"i360-sort-header",11),r["\u0275\u0275text"](17),r["\u0275\u0275pipe"](18,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](19,re,1,1,"ng-template",12),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](20,"i360-column",13)(21,"i360-sort-header",14),r["\u0275\u0275text"](22),r["\u0275\u0275pipe"](23,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](24,oe,3,2,"ng-template",12),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](25,"i360-column",15)(26,"i360-sort-header",16),r["\u0275\u0275text"](27),r["\u0275\u0275pipe"](28,"translate"),r["\u0275\u0275elementEnd"]()(),r["\u0275\u0275elementStart"](29,"i360-column")(30,"i360-sort-header",17),r["\u0275\u0275text"](31),r["\u0275\u0275pipe"](32,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](33,de,2,1,"ng-container",18),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](34,"i360-column")(35,"i360-sort-header",19),r["\u0275\u0275text"](36),r["\u0275\u0275pipe"](37,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](38,se,4,6,"div",20),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](39,"i360-actions-column")(40,"i360-action",21),r["\u0275\u0275listener"]("perform",(function(e){return t.showDetails(e[0].id)})),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](41,"i360-action",22)(42,"i360-action",23),r["\u0275\u0275listener"]("perform",(function(e){return t.viewFile(e[0])})),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](43,"i360-action",24),r["\u0275\u0275listener"]("perform",(function(e){return t.addToIgnore(e,!0)})),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](44,"i360-action",25),r["\u0275\u0275listener"]("perform",(function(e){return t.addToIgnore(e)})),r["\u0275\u0275elementEnd"]()()()()()()),2&e&&(r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("i360-request",t.proactiveDefenseService.list),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("filter",r["\u0275\u0275pureFunction0"](23,pe)),r["\u0275\u0275advance"](4),r["\u0275\u0275property"]("simplePagination",!0),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("defaultValue",r["\u0275\u0275pureFunction0"](24,ce)),r["\u0275\u0275advance"](4),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](13,11,"pd.events.headers.detectionTime")," "),r["\u0275\u0275advance"](5),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](18,13,"pd.events.headers.reason")," "),r["\u0275\u0275advance"](5),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](23,15,"pd.events.headers.scriptPath")," "),r["\u0275\u0275advance"](5),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](28,17,"pd.events.headers.host")," "),r["\u0275\u0275advance"](4),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](32,19,"pd.events.headers.ip")," "),r["\u0275\u0275advance"](5),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](37,21,"pd.events.headers.action")," "),r["\u0275\u0275advance"](7),r["\u0275\u0275property"]("filter",r["\u0275\u0275pureFunction0"](25,pe)))},dependencies:[I.NgIf,l.e,b.a,S.b,U.W,Q.O,Z.w,G.H,X.a,W.S,J.H,w.PS,K.My,z.O,Y.O,ee.J,te.a,ne.P,s.v,k.t,ie.F,I.LowerCasePipe,_.X$],styles:[".tries-count[_ngcontent-%COMP%] {\n  display: inline-block;\n  padding: 0 10px;\n  border-radius: 8.5px;\n  background-color: #bebebe;\n  color: white;\n}"]}),(0,a.gn)([d.U],me.prototype,"showDetails",null),(0,a.gn)([d.U],me.prototype,"addToIgnore",null),(0,a.gn)([d.U],me.prototype,"viewFile",null);var ue=n(80134),fe=n(92521),ve=n(14633),he=n(82247);let ge=(()=>{class e{constructor(e){this.chip=e,this.chip.selectable=!1}onClick(e){/\bmat-chip-remove\b/.test(e.target.className)||this.chip.remove()}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](he.MatChip))},e.\u0275dir=r["\u0275\u0275defineDirective"]({type:e,selectors:[["mat-chip","i360-chip",""]],hostBindings:function(e,t){1&e&&r["\u0275\u0275listener"]("click",(function(e){return t.onClick(e)}))}}),e})();const xe=["removeModal"];function ye(e,t){if(1&e&&r["\u0275\u0275element"](0,"clock",18),2&e){const e=t.$implicit;r["\u0275\u0275property"]("timestamp",e.timestamp)}}function Ie(e,t){if(1&e&&r["\u0275\u0275text"](0),2&e){const e=t.$implicit;r["\u0275\u0275textInterpolate"](e.path)}}function be(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"mat-chip",23),r["\u0275\u0275listener"]("removed",(function(){const t=r["\u0275\u0275restoreView"](e).$implicit,n=r["\u0275\u0275nextContext"](2).$implicit,i=r["\u0275\u0275nextContext"]();return r["\u0275\u0275resetView"](i.deleteRule(n,t))})),r["\u0275\u0275element"](1,"i360-ellipsis",24),r["\u0275\u0275elementStart"](2,"mat-icon",25),r["\u0275\u0275text"](3,"close"),r["\u0275\u0275elementEnd"]()()}if(2&e){const e=t.$implicit;r["\u0275\u0275property"]("removable",!0),r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("text",e.name)}}function Se(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"mat-chip-list",21),r["\u0275\u0275pipe"](1,"translate"),r["\u0275\u0275template"](2,be,4,2,"mat-chip",22),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]().$implicit;r["\u0275\u0275attribute"]("aria-label",r["\u0275\u0275pipeBind1"](1,2,"pd.ignoreList.headers.rules")),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngForOf",e.rules)}}function we(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"mat-chip-list",21),r["\u0275\u0275pipe"](1,"translate"),r["\u0275\u0275elementStart"](2,"mat-chip",26),r["\u0275\u0275text"](3),r["\u0275\u0275pipe"](4,"translate"),r["\u0275\u0275elementEnd"]()()),2&e&&(r["\u0275\u0275attribute"]("aria-label",r["\u0275\u0275pipeBind1"](1,2,"pd.ignoreList.headers.rules")),r["\u0275\u0275advance"](3),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](4,4,"pd.ignoreList.allRulesChip")))}function Ce(e,t){if(1&e&&(r["\u0275\u0275template"](0,Se,3,4,"mat-chip-list",19),r["\u0275\u0275template"](1,we,5,6,"ng-template",null,20,r["\u0275\u0275templateRefExtractor"])),2&e){const e=t.$implicit,n=r["\u0275\u0275reference"](2);r["\u0275\u0275property"]("ngIf",e.rules&&e.rules.length)("ngIfElse",n)}}function Ee(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"i360-modal-content",27),r["\u0275\u0275elementContainerStart"](1,28),r["\u0275\u0275text"](2),r["\u0275\u0275pipe"](3,"translate"),r["\u0275\u0275elementContainerEnd"](),r["\u0275\u0275elementContainerStart"](4,29),r["\u0275\u0275elementStart"](5,"p")(6,"strong"),r["\u0275\u0275text"](7),r["\u0275\u0275pipe"](8,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](9),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](10,"p")(11,"strong"),r["\u0275\u0275text"](12),r["\u0275\u0275pipe"](13,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275text"](14),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementContainerEnd"](),r["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](3,5,"pd.ignoreList.removeModal.title")),r["\u0275\u0275advance"](5),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](8,7,"pd.ignoreList.removeModal.path")),r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate1"](" ",e.item.path,""),r["\u0275\u0275advance"](3),r["\u0275\u0275textInterpolate"](r["\u0275\u0275pipeBind1"](13,9,"pd.ignoreList.removeModal.rule")),r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate1"](" ",e.rule.name,"")}}const Me=function(){return["timestamp-"]};class _e{constructor(e,t,n){this.proactiveDefenseService=e,this.modalService=t,this.notifications=n}deletePaths(e){var t=this;return(0,i.Z)((function*(){const n=e.map((e=>e.path));(yield t.modalService.confirm("proactive-remove-from-ignore",n))&&(yield(0,o.firstValueFrom)(t.proactiveDefenseService.ignoreDeletePaths({paths:n}),{defaultValue:void 0}),t.notifications.success("pd.ignoreList.notifications.successfullyRemoved",null,{count:e.length}),yield t.request.load())}))()}deleteRule(e,t){var n=this;return(0,i.Z)((function*(){(yield n.modalService.open(n.removeModal,{data:{item:e,rule:t}}))&&(yield(0,o.firstValueFrom)(n.proactiveDefenseService.ignoreDeleteRule({path:e.path,id:t.id}),{defaultValue:void 0}),n.notifications.success("pd.ignoreList.notifications.successfullyRemoved",null,{count:1}),yield n.request.load())}))()}viewFile(e){var t=this;return(0,i.Z)((function*(){yield t.modalService.openFileViewer(e.path)}))()}}_e.\u0275fac=function(e){return new(e||_e)(r["\u0275\u0275directiveInject"](x),r["\u0275\u0275directiveInject"](f.Z),r["\u0275\u0275directiveInject"](H.T))},_e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:_e,selectors:[["i360-proactive-defense-ignore-list"]],viewQuery:function(e,t){if(1&e&&(r["\u0275\u0275viewQuery"](l.e,7),r["\u0275\u0275viewQuery"](s.v,7),r["\u0275\u0275viewQuery"](xe,7)),2&e){let e;r["\u0275\u0275queryRefresh"](e=r["\u0275\u0275loadQuery"]())&&(t.loader=e.first),r["\u0275\u0275queryRefresh"](e=r["\u0275\u0275loadQuery"]())&&(t.request=e.first),r["\u0275\u0275queryRefresh"](e=r["\u0275\u0275loadQuery"]())&&(t.removeModal=e.first)}},decls:26,vars:11,consts:[[3,"i360-request"],["i360-timeframe",""],["i360-search",""],["i360-paginator","",3,"simplePagination"],["i360-limit",""],["icon","delete","title","pd.ignoreList.groupActions.remove",3,"perform"],["i360-main-view","","i360-sortable","",3,"defaultValue"],["labelField","path"],["field","timestamp","startWith","-"],[3,"timestamp",4,"i360HostTemplate"],["classes","rtl-except"],["field","path"],["i360HostTemplate",""],["headerText","pd.ignoreList.headers.rules"],[3,"width"],["icon","remove_red_eye","title","pd.ignoreList.actions.viewFile",3,"perform"],["icon","delete","title","pd.ignoreList.actions.remove",3,"perform"],["removeModal",""],[3,"timestamp"],["class","i360-chips",4,"ngIf","ngIfElse"],["allRules",""],[1,"i360-chips"],["i360-chip","",3,"removable","removed",4,"ngFor","ngForOf"],["i360-chip","",3,"removable","removed"],[3,"text"],["matChipRemove",""],["i360-chip",""],["i360-dialog-template","","confirmText","pd.ignoreList.removeModal.confirm"],["modal-title",""],["modal-body",""]],template:function(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"div")(1,"i360-data-view",0),r["\u0275\u0275element"](2,"i360-widget",1)(3,"i360-widget",2)(4,"i360-widget",3)(5,"i360-widget",4),r["\u0275\u0275elementStart"](6,"i360-action",5),r["\u0275\u0275listener"]("perform",(function(e){return t.deletePaths(e)})),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](7,"i360-table",6),r["\u0275\u0275element"](8,"i360-checkbox-column",7),r["\u0275\u0275elementStart"](9,"i360-column")(10,"i360-sort-header",8),r["\u0275\u0275text"](11),r["\u0275\u0275pipe"](12,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](13,ye,1,1,"clock",9),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](14,"i360-column",10)(15,"i360-sort-header",11),r["\u0275\u0275text"](16),r["\u0275\u0275pipe"](17,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](18,Ie,1,1,"ng-template",12),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](19,"i360-column",13),r["\u0275\u0275template"](20,Ce,3,2,"ng-template",12),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](21,"i360-actions-column",14)(22,"i360-action",15),r["\u0275\u0275listener"]("perform",(function(e){return t.viewFile(e[0])})),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](23,"i360-action",16),r["\u0275\u0275listener"]("perform",(function(e){return t.deletePaths(e)})),r["\u0275\u0275elementEnd"]()()()()(),r["\u0275\u0275template"](24,Ee,15,11,"ng-template",null,17,r["\u0275\u0275templateRefExtractor"])),2&e&&(r["\u0275\u0275advance"](1),r["\u0275\u0275property"]("i360-request",t.proactiveDefenseService.ignoreList),r["\u0275\u0275advance"](3),r["\u0275\u0275property"]("simplePagination",!0),r["\u0275\u0275advance"](3),r["\u0275\u0275property"]("defaultValue",r["\u0275\u0275pureFunction0"](10,Me)),r["\u0275\u0275advance"](4),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](12,6,"pd.ignoreList.headers.dateTime")," "),r["\u0275\u0275advance"](5),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](17,8,"pd.ignoreList.headers.path")," "),r["\u0275\u0275advance"](5),r["\u0275\u0275property"]("width",100))},dependencies:[I.NgForOf,I.NgIf,l.e,b.a,S.b,U.W,Q.O,Z.w,G.H,X.a,W.S,J.H,w.PS,K.My,Y.O,ee.J,te.a,ne.P,s.v,M.E,ue.Z,fe.S,ve.MatIcon,he.MatChipList,he.MatChip,he.MatChipRemove,ie.F,ge,_.X$],encapsulation:2}),(0,a.gn)([d.U],_e.prototype,"deletePaths",null),(0,a.gn)([d.U],_e.prototype,"deleteRule",null),(0,a.gn)([d.U],_e.prototype,"viewFile",null);var ke=n(88568),Pe=n(21722),Oe=n(40660),Fe=n(52191),Re=n(26203),De=n(43824),Le=n(3594),Te=n(67765),Ae=n(50872),je=n(53530),Be=n(45271),Ve=n(94395),Ne=n(20218),$e=n(58603);function qe(e,t){if(1&e&&(r["\u0275\u0275elementStart"](0,"i360-warning-message",19),r["\u0275\u0275text"](1),r["\u0275\u0275pipe"](2,"translate"),r["\u0275\u0275elementEnd"]()),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](2,1,e.disableMessage)," ")}}const He=function(e){return{mode:e}},Ue=function(e){return{key:"pd.mode.notifications.changed",params:e}};let Qe=(()=>{class e{constructor(e,t,n){this.config=e,this.authState=t,this.myImunifyService=n,this.Mode=h.AR,this.destroy$=new o.Subject,(0,o.combineLatest)([this.config.changes,this.myImunifyService.getMyImunifyState(),this.authState.isClient]).pipe((0,o.takeUntil)(this.destroy$)).subscribe((([e,t,n])=>{this.updateDisabledState(e,t,n)}))}ngOnDestroy(){this.destroy$.next()}changeModeHandler(e){e.querySelector("input").click()}updateDisabledState(e,t,n){if(t.enabled&&!t.protection)return this.disableMode=!0,void(this.disableMessage="");const i=n&&!1===e.PERMISSIONS.user_override_proactive_defense;this.disableMode=e.PROACTIVE_DEFENCE.php_immunity||i,this.disableMessage=i?"warning.set_by_admin":"warning.php_immunity_enabled"}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](Le.p),r["\u0275\u0275directiveInject"](v.j),r["\u0275\u0275directiveInject"](Pe.K))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["i360-mode"]],decls:32,vars:29,consts:[["i360Config","",3,"formGroup","successSaveMessage"],["config","i360Config"],["formGroupName","PROACTIVE_DEFENCE"],["formControlName","mode",1,"canvas","flexer",3,"change"],["mode","matRadioGroup"],["class","full-width",4,"ngIf"],[1,"canvas-body","flexer"],["i360Loader","",1,"proactive-mode-item"],["translate","",1,"mode-title","text-nowrap"],["id","disabled-mode","matRipple","",1,"proactive-mode-item",3,"matRippleDisabled","click"],["disabledMode",""],[3,"disabled","value"],["id","log-mode","matRipple","",1,"proactive-mode-item",3,"matRippleDisabled","click"],["logMode",""],[1,"severity-icon","log"],["i360-description","","translate",""],["id","kill-mode","matRipple","",1,"proactive-mode-item",3,"matRippleDisabled","click"],["killMode",""],[1,"severity-icon","kill"],[1,"full-width"]],template:function(e,t){if(1&e){const e=r["\u0275\u0275getCurrentView"]();r["\u0275\u0275elementStart"](0,"form",0,1),r["\u0275\u0275pipe"](2,"uppercase"),r["\u0275\u0275elementStart"](3,"div",2)(4,"mat-radio-group",3,4),r["\u0275\u0275listener"]("change",(function(){r["\u0275\u0275restoreView"](e);const t=r["\u0275\u0275reference"](1);return r["\u0275\u0275resetView"](t.updateConfig())})),r["\u0275\u0275template"](6,qe,3,3,"i360-warning-message",5),r["\u0275\u0275elementStart"](7,"div",6)(8,"div",7)(9,"div",8),r["\u0275\u0275text"](10,"pd.mode.title"),r["\u0275\u0275elementEnd"]()(),r["\u0275\u0275elementStart"](11,"div",9,10),r["\u0275\u0275listener"]("click",(function(){r["\u0275\u0275restoreView"](e);const n=r["\u0275\u0275reference"](12);return r["\u0275\u0275resetView"](t.changeModeHandler(n))})),r["\u0275\u0275elementStart"](13,"mat-radio-button",11),r["\u0275\u0275text"](14),r["\u0275\u0275pipe"](15,"translate"),r["\u0275\u0275elementEnd"]()(),r["\u0275\u0275elementStart"](16,"div",12,13),r["\u0275\u0275listener"]("click",(function(){r["\u0275\u0275restoreView"](e);const n=r["\u0275\u0275reference"](17);return r["\u0275\u0275resetView"](t.changeModeHandler(n))})),r["\u0275\u0275elementStart"](18,"mat-radio-button",11),r["\u0275\u0275text"](19),r["\u0275\u0275pipe"](20,"translate"),r["\u0275\u0275element"](21,"span",14),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](22,"div",15),r["\u0275\u0275text"](23,"pd.mode.modes.descriptions.log"),r["\u0275\u0275elementEnd"]()(),r["\u0275\u0275elementStart"](24,"div",16,17),r["\u0275\u0275listener"]("click",(function(){r["\u0275\u0275restoreView"](e);const n=r["\u0275\u0275reference"](25);return r["\u0275\u0275resetView"](t.changeModeHandler(n))})),r["\u0275\u0275elementStart"](26,"mat-radio-button",11),r["\u0275\u0275text"](27),r["\u0275\u0275pipe"](28,"translate"),r["\u0275\u0275element"](29,"span",18),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](30,"div",15),r["\u0275\u0275text"](31,"pd.mode.modes.descriptions.kill"),r["\u0275\u0275elementEnd"]()()()()()()}if(2&e){const e=r["\u0275\u0275reference"](1),n=r["\u0275\u0275reference"](5);r["\u0275\u0275property"]("formGroup",e.form)("successSaveMessage",r["\u0275\u0275pureFunction1"](27,Ue,r["\u0275\u0275pureFunction1"](25,He,r["\u0275\u0275pipeBind1"](2,17,n.value)))),r["\u0275\u0275advance"](4),r["\u0275\u0275classProp"]("disabled",t.disableMode),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngIf",t.disableMode&&t.disableMessage),r["\u0275\u0275advance"](5),r["\u0275\u0275property"]("matRippleDisabled",t.disableMode),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("disabled",t.disableMode)("value",t.Mode.disabled),r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](15,19,"pd.mode.modes.disabled")," "),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("matRippleDisabled",t.disableMode),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("disabled",t.disableMode)("value",t.Mode.log),r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](20,21,"pd.mode.modes.log")," "),r["\u0275\u0275advance"](5),r["\u0275\u0275property"]("matRippleDisabled",t.disableMode),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("disabled",t.disableMode)("value",t.Mode.kill),r["\u0275\u0275advance"](1),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](28,23,"pd.mode.modes.kill")," ")}},dependencies:[I.NgIf,l.e,Te["\u0275NgNoValidate"],Te.NgControlStatus,Te.NgControlStatusGroup,Te.FormGroupDirective,Te.FormControlName,Te.FormGroupName,Ae.O,je.J,E.F,_.Pi,Be.MatRipple,Ve.MatRadioGroup,Ve.MatRadioButton,Ne.R,O.w,$e.C,I.UpperCasePipe,_.X$],styles:["[_nghost-%COMP%] {\n  margin-bottom: 30px;\n  display: inline-block;\n}\n\ndiv.proactive-mode-item[_ngcontent-%COMP%] {\n  min-width: 130px;\n  padding: 24px;\n  display: inline-block;\n  position: relative;\n  margin: 0;\n}\n\ndiv.proactive-mode-item.mat-ripple[_ngcontent-%COMP%] {\n  position: relative;\n}\n\n@media (max-width: 900px) {\n  div.proactive-mode-item[_ngcontent-%COMP%] {\n    width: 100%;\n  }\n}\n\n@media (min-width: 900px) {\n  .canvas-body[_ngcontent-%COMP%] {\n    flex-wrap: nowrap;\n  }\n}\n\n.canvas[_ngcontent-%COMP%]   i360-warning-message[_ngcontent-%COMP%] {\n  width: 100%;\n  margin: 20px 24px 0;\n}\n\n.canvas[_ngcontent-%COMP%]   .align-center[_ngcontent-%COMP%] {\n  color: blue !important;\n}\n\n.canvas[_ngcontent-%COMP%]:not(.disabled)   .proactive-mode-item[matRipple][_ngcontent-%COMP%] {\n  cursor: pointer;\n}\n\n.canvas[_ngcontent-%COMP%]:not(.disabled)   .proactive-mode-item[matRipple][_ngcontent-%COMP%]:hover {\n  background-color: #e9f6ee;\n}\n\n.mode-title[_ngcontent-%COMP%] {\n  font-size: 14px;\n  font-weight: bold;\n}\n\n.ltr[_nghost-%COMP%]   .severity-icon[_ngcontent-%COMP%], .ltr   [_nghost-%COMP%]   .severity-icon[_ngcontent-%COMP%] {\n  margin-left: 9px;\n}\n\n.rtl[_nghost-%COMP%]   .severity-icon[_ngcontent-%COMP%], .rtl   [_nghost-%COMP%]   .severity-icon[_ngcontent-%COMP%] {\n  margin-right: 9px;\n}\n\nmat-radio-group[_ngcontent-%COMP%] {\n  padding-bottom: 0;\n}"]}),e})();function Ze(e,t){if(1&e&&r["\u0275\u0275element"](0,"i360-protection-status",5),2&e){const e=r["\u0275\u0275nextContext"]();r["\u0275\u0275property"]("isEnabledProtection",e.myImunifyState.protection)("maliciousCount",e.maliciousCount)("maliciousFixed",e.maliciousFixed)}}let Ge=(()=>{class e{constructor(e,t,n){this.cdr=e,this.myImunifyService=t,this.maliciousService=n,this.destroy$=new o.Subject,this.listenMyImunify()}listenMyImunify(){this.myImunifyService.getMyImunifyState().pipe((0,o.takeUntil)(this.destroy$)).subscribe((e=>{this.myImunifyState=e,this.myImunifyState.enabled&&this.loadMaliciousCounts(),this.cdr.markForCheck()}))}loadMaliciousCounts(){this.maliciousService.list({offset:0,limit:100,since:0}).pipe((0,o.take)(1)).subscribe({next:e=>{this.maliciousCount=e?.data?.malicious_count||0,this.maliciousFixed=(0,ke.Y)(e?.data?.items),this.cdr.markForCheck()},error:o.noop})}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](r.ChangeDetectorRef),r["\u0275\u0275directiveInject"](Pe.K),r["\u0275\u0275directiveInject"](Oe.w))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["i360-proactive-defense"]],decls:12,vars:7,consts:[[3,"subheader"],["class","proactive-defense__protection-status",3,"isEnabledProtection","maliciousCount","maliciousFixed",4,"ngIf"],[1,"proactive-defense__tabs"],["routerLink","events","routerLinkActive","active","translate",""],["routerLink","ignore-list","routerLinkActive","active","translate",""],[1,"proactive-defense__protection-status",3,"isEnabledProtection","maliciousCount","maliciousFixed"]],template:function(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"i360-header",0),r["\u0275\u0275pipe"](1,"translate"),r["\u0275\u0275text"](2),r["\u0275\u0275pipe"](3,"translate"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275template"](4,Ze,1,3,"i360-protection-status",1),r["\u0275\u0275element"](5,"i360-mode"),r["\u0275\u0275elementStart"](6,"i360-tabs",2)(7,"a",3),r["\u0275\u0275text"](8,"pd.navigation.detectedEvents"),r["\u0275\u0275elementEnd"](),r["\u0275\u0275elementStart"](9,"a",4),r["\u0275\u0275text"](10,"pd.navigation.ignoreList"),r["\u0275\u0275elementEnd"]()(),r["\u0275\u0275element"](11,"router-outlet")),2&e&&(r["\u0275\u0275property"]("subheader",r["\u0275\u0275pipeBind1"](1,3,"pd.subtitle")),r["\u0275\u0275advance"](2),r["\u0275\u0275textInterpolate1"](" ",r["\u0275\u0275pipeBind1"](3,5,"pd.title"),"\n"),r["\u0275\u0275advance"](2),r["\u0275\u0275property"]("ngIf",null==t.myImunifyState?null:t.myImunifyState.enabled))},dependencies:[Fe.RouterOutlet,Fe.RouterLinkWithHref,Fe.RouterLinkActive,I.NgIf,C.w,Re.n,_.Pi,De.c,Qe,_.X$],styles:[".proactive-defense__tabs[_ngcontent-%COMP%] {\n  margin-bottom: 31px;\n}\n.proactive-defense__protection-status[_ngcontent-%COMP%] {\n  margin-bottom: 31px;\n}"]}),e})();var Xe=n(45361),We=n(62143),Je=n(69679),Ke=n(27276),ze=n(80586),Ye=n(48810),et=n(38684),tt=n(84302);let nt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=r["\u0275\u0275defineInjector"]({providers:[x,Oe.w],imports:[Fe.RouterModule,I.CommonModule,We.V,Je.Q,Ke.a,ze.r,Xe.z,Ye.l,tt.I,Fe.RouterModule.forChild([{path:"",component:Ge,children:[{path:"",redirectTo:"events",pathMatch:"full"},{path:"events",component:me},{path:"ignore-list",component:_e}]}]),et.m]}),e})()},63326:(e,t,n)=>{n.d(t,{$:()=>p,k:()=>s});var i=n(71670),a=n(16141),r=n(53850),o=n(73842),l=n(92962),d=n(64650);const s={white:"utils.table.widgets.content.purpose.values.white",drop:"utils.table.widgets.content.purpose.values.drop",captcha:"utils.table.widgets.content.purpose.values.captcha",splashscreen:"utils.table.widgets.content.purpose.values.splashscreen"};let p=(()=>{class e{constructor(e,t,n){this.modalService=e,this.notifications=t,this.xhr=n,this.getALL=this.xhr.wrap(this.xhr.rx(a.Xi.getAllList),a.HC),this.addOrUpdateItems=this.xhr.request(a.Xi.addOrUpdateItem,!1),this.deleteItems=this.xhr.request(a.Xi.deleteItems),this.editItem=this.xhr.request(a.Xi.editItem)}changeListWithConfirm(e,t,n){const i=this.getActionAndRequest(e,t,n);return this.confirmListChangeAndNotify(i.request,i.action,e,i.confirmName)}changeListWithConfirmFromIncidents(e,t,n){var a=this;return(0,i.Z)((function*(){const i=a.getActionAndRequest([],e[0].list,t,n);if(!i)return!1;const r=Array.from(new Set(e.map((e=>e.ip)))),o=yield a.modalService.confirm(i.confirmName,r);if(o){for(let[n,i]of a.sortIps(e)){const e=Array.from(i),r=a.getActionAndRequest(e,n,t);try{yield a.confirmListChangeAndNotify(r.request,r.action,e,null)}catch(e){}}n&&t&&(yield a.addOrUpdateItems({value:r,scope:n,list:t}))}return o}))()}sortIps(e){let t=new Map;for(let{list:n,ip:i}of e){let e=t.get(n)||new Set;e.add(i),t.set(n,e)}return t}getActionAndRequest(e,t,n,i){let a,r,o;if(null===t||null!==n){if(o=`add-to-${n}`,null===t&&null!==n)a="added";else{if(null===n)throw new Error("impossible");a="moved"}r=()=>this.addOrUpdateItems({value:e,list:n})}else a="deleted",o="delete-ip-from-list",r=()=>this.deleteItems({itemType:"ip",items:e,list:t});return i&&(o+=`-${i}-scope`),{action:a,confirmName:o,request:r}}confirmListChangeAndNotify(e,t,n,a){var r=this;return(0,i.Z)((function*(){return!(a&&!(yield r.modalService.confirm(a,n)))&&(yield e(),r.notifications.success("notifications.ipAction",null,{count:n.length,action:t}),!0)}))()}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275inject"](o.Z),r["\u0275\u0275inject"](l.T),r["\u0275\u0275inject"](d.K))},e.\u0275prov=r["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})()}}]);
//# sourceMappingURL=src_app_components_proactive-defense_proactive-defense_module_ts.js.map