(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{1038:function(e,t,n){"use strict";n.r(t);var r=n(723),o=n(9),c=(n(25),n(40),n(30),n(32),n(81),n(22),n(41),n(31),n(1)),l=n(124),m=n(289),d=n(966),v=n(720),f=n(197),j=n(67),h=n(112),O=n(288),x=n(287),y=Object(c.b)({name:"DeleteProject",components:{FormFooter:x.a,SideScreen:O.a,Richtext:h.a,InputField:m.a},props:{projectName:{type:String,default:""},initiateDelete:{type:Boolean,default:!1}},setup:function(e){var t=Object(c.r)(),n=Object(c.o)(),r=Object(c.p)(),m=Object(c.l)().$apiClient,d=Object(c.i)(""),v=Object(c.i)(!1),f=Object(c.i)(!1),h=n.value.params.pid,O=Object(c.a)((function(){return t.getters["navigation/getNavAliases"]})),x=Object(c.a)((function(){return t.getters["projects/getActualSystemSKU"]})),y=Object(c.a)((function(){return!!d.value.length&&d.value===e.projectName})),_=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.getRepository("project");case 3:return o=e.sent,e.next=6,o.delete(h,{cancel_subscription:v.value});case 6:f.value=!0,setTimeout((function(){t.dispatch("ui/closeMetaSidebar"),r.push(Object(l.d)(O.value.projectsOverview.path,0,0,n.value)),t.dispatch("projects/updateProject")}),3e3),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return{formName:d,formDeleteSubscription:v,checkName:y,deleteProject:_,sku:x,checkSku:j.a}}}),_=y,S=n(4),k=Object(S.a)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("SideScreen",{attrs:{"is-open":e.initiateDelete},scopedSlots:e._u([{key:"headline",fn:function(){return[e._v("\n    "+e._s(e.$t("deleteProject"))+"\n  ")]},proxy:!0},{key:"subline",fn:function(){return[e._v("\n    "+e._s(e.$t("projectWillBeDeletedSentence"))+"\n  ")]},proxy:!0},{key:"body",fn:function(){return[n("InputField",{attrs:{name:"projectName"},model:{value:e.formName,callback:function(t){e.formName=t},expression:"formName"}},[n("Richtext",{staticClass:"hover:cursor-default",attrs:{content:e.$tc("projectDeleteHint",1,{name:e.projectName})}})],1),e._v(" "),"lite"!==e.checkSku(e.sku)?n("div",{staticClass:"flex flex-col my-4 p-2 text-sm text-gray-600 "},[n("p",{staticClass:"text-gray-500"},[e._v("\n        "+e._s(e.$t("Optional"))+"\n      ")]),e._v(" "),n("p",{staticClass:"flex items-center gap-2"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.formDeleteSubscription,expression:"formDeleteSubscription"}],attrs:{id:"checkbox",type:"checkbox",value:""},domProps:{checked:Array.isArray(e.formDeleteSubscription)?e._i(e.formDeleteSubscription,"")>-1:e.formDeleteSubscription},on:{change:function(t){var n=e.formDeleteSubscription,r=t.target,o=!!r.checked;if(Array.isArray(n)){var c=e._i(n,"");r.checked?c<0&&(e.formDeleteSubscription=n.concat([""])):c>-1&&(e.formDeleteSubscription=n.slice(0,c).concat(n.slice(c+1)))}else e.formDeleteSubscription=o}}}),e._v(" "),n("label",{attrs:{for:"checkbox"}},[e._v("\n          "+e._s(e.$t("formDeleteAlsoSubscription"))+"\n        ")])])]):e._e()]},proxy:!0},{key:"footer",fn:function(){return[n("FormFooter",{attrs:{config:"disable","with-opt-in":!1,"is-disable-disabled":e.checkName},on:{disable:e.deleteProject,cancel:function(t){return e.$emit("closeModal")}}})]},proxy:!0}])})}),[],!1,null,null,null).exports,w=n(967),D=n(80),C={name:"EditProject"};C.props={storybook:{type:Boolean,default:!1}},C.setup=function(e,t){var n=Object(c.l)(),r=n.$apiClient,m=n.$sentry,d=Object(c.o)(),v=Object(c.i)([]),f=Object(c.i)(null),j=Object(c.r)(),h=Object(c.i)(!0),O=Object(c.i)(null),x=(Object(c.i)(!1),Object(c.i)(null)),y=Object(c.i)(null),_=Object(c.i)(!1),S=Object(c.i)(!1),k=Object(c.i)(!1),w=Object(c.i)(""),D=Object(c.h)({protocol:"https",name:"",location:{identifier:"",name:""},domain:""}),C=j.getters["projects/getActualLocation"],P=Object(c.i)({identifier:C,name:""}),$=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,f.value=null,e.next=4,r.getRepositoryCollection().then((function(e){return e.getLocationRepository()}));case 4:return t=e.sent,e.next=7,t.list();case 7:n=e.sent,v.value=n,P.value=n.find((function(e){return e.identifier===F.value.identifier})),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),f.value=e.t0.message;case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();Object(c.f)((function(){$()}));var N=e,R=Object(c.a)((function(){return j.getters["projects/getActualSystemDomain"]})),A=Object(c.a)((function(){return j.getters["projects/getActualSystemName"]})),F=Object(c.a)((function(){return P.value||{identifier:"",name:""}})),L=Object(c.a)((function(){return j.getters["projects/getActualProject"]})),E=Object(c.a)((function(){return j.getters["projects/getActualSystem"]})),I=(Object(c.a)((function(){return j.getters["onboarding/getOnboarding"]})),Object(c.a)((function(){return j.getters["projects/getActualProjectDetails"]})));D.name=A.value,D.location=F.value,D.protocol=Object(l.e)(R.value)||"https",D.domain="https://www.example.com"!==R.value?R.value.split("://")[1]:null,O.value=R.value;var B=Object(c.a)((function(){return null!==D.name&&(D.name.length>=3&&D.name.length<=30)})),T=Object(c.a)((function(){return B.value&&h.value})),U=Object(c.h)({min:3,max:250}),G=Object(c.a)((function(){var e,t;return(null===(e=D.name)||void 0===e?void 0:e.length)<U.min?"nameTooShort":(null===(t=D.name)||void 0===t?void 0:t.length)>U.max?"nameTooLong":""}));Object(c.f)((function(){J()}));var H=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){var t,n,o,c,l,v,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w.value="",t=d.value.params,n=t.pid,o=t.sid,!T.value){e.next=26;break}return e.prev=3,e.next=6,r.getRepository("project");case 6:return c=e.sent,l=c.update(n,{name:D.name,location:D.location.identifier}),e.next=10,r.getRepository("system");case 10:return v=e.sent,f=v.updateSystem(o,{base_url:O.value}),e.next=14,Promise.all([l,f]);case 14:j.dispatch("projects/updateProject"),j.dispatch("onboarding/activateSystem"),_.value=!0,M(),setTimeout((function(){J()}),3e4),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(3),w.value=e.t0.response.data.message,console.error(e.t0),m.captureException(e.t0);case 26:case"end":return e.stop()}}),e,null,[[3,21]])})));return function(){return e.apply(this,arguments)}}(),M=function(){j.dispatch("projects/updateProject")},J=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){var t,image;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N.storybook){e.next=2;break}return e.abrupt("return");case 2:if(!L.value){e.next=19;break}return e.prev=3,e.next=6,r.getRepository("screenshot");case 6:return t=e.sent,e.next=9,t.getScreenshot(E.value);case 9:(image=e.sent)&&(x.value=image.screenshot.thumbnail,y.value=image.screenshot.raw),_.value=!1,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),console.error(e.t0);case 17:e.next=22;break;case 19:x.value="",y.value="",_.value=!1;case 22:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(){return e.apply(this,arguments)}}();return{locations:v,screenShot:x,imagePending:_,initiateDelete:S,showInitiateDelete:k,apiError:w,projectData:D,domain:R,actualProject:I,enableStoring:T,nameLength:U,errorName:G,urlStatusChange:function(e){h.value=e.status},updateLocation:function(e){D.location=e},updateUrl:function(e){O.value=e},storeProject:H,deleteProject:function(){k.value=!0,S.value=!0},handleCloseDelete:function(){S.value=!1,setTimeout((function(){k.value=!1}),100)}}},C.components=Object.assign({Dimensions:v.a,Skeleton:f.a,InputField:m.a,LocationSelect:d.a,UrlInput:w.a,GeneralButton:D.a,DeleteProject:k},C.components);var P=C,$=(n(937),Object(S.a)(P,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{attrs:{"action.prevent":"","data-cy":"element"}},[n("Dimensions",{scopedSlots:e._u([{key:"default",fn:function(t){var r=t.width;return n("div",{staticClass:"grid-twoColumOneFixed",class:[{"grid-twoColumOneFixed--small":r<750},{"grid-twoColumOneFixed--big":r>=750}]},[n("div",{staticClass:"grid-twoColumOneFixed__1"},[n("figure",{staticClass:"border-gray-300 border-solid border p-3"},[e.screenShot?e._e():n("div",{staticClass:"aspect-ratio-4/3 h-0 overflow-hidden relative"},[n("div",{staticClass:"bg-gray-200 absolute w-full h-full"})]),e._v(" "),e.screenShot?n("div",{staticClass:"aspect-ratio-4/3 h-0 overflow-hidden relative"},[e.imagePending?n("Skeleton",{attrs:{"full-size":!0,round:!1}}):e._e(),e._v(" "),e.imagePending?e._e():n("img",{staticClass:"object-cover w-full object-top",attrs:{src:e.screenShot,alt:"screenshot"}})],1):e._e()])]),e._v(" "),n("div",{staticClass:"grid-twoColumOneFixed__2"},[n("div",[n("InputField",{staticClass:"mb-6",attrs:{name:"name",placeholder:e.$t("projectNamePlaceholder"),error:null!==e.projectData.name?e.$t(e.errorName,{},{min:e.nameLength.min,max:e.nameLength.max}):""},model:{value:e.projectData.name,callback:function(t){e.$set(e.projectData,"name",t)},expression:"projectData.name"}},[e._v("\n            "+e._s(e.$t("projectName"))+"\n          ")]),e._v(" "),n("LocationSelect",{attrs:{location:e.projectData.location,locations:e.locations},on:{updateLocation:e.updateLocation}},[e._v("\n            "+e._s(e.$t("locationSelectTitle"))+"\n          ")]),e._v(" "),n("UrlInput",{attrs:{url:e.domain,"api-error":e.apiError},on:{urlInput:e.updateUrl,validationStatusChange:e.urlStatusChange}}),e._v(" "),n("div",{staticClass:"flex justify-end"},[0===e.actualProject.role.id?n("GeneralButton",{staticClass:"mr-4",attrs:{"data-cy":"trigger-deleteButton","color-palette":"caution","button-style":"text-white bg-gray-500 hover:bg-error-high hover:text-white"},nativeOn:{click:function(t){return e.deleteProject.apply(null,arguments)}}},[e._v("\n              "+e._s(e.$t("delete"))+"\n            ")]):e._e(),e._v(" "),n("GeneralButton",{attrs:{"data-cy":"trigger-store","is-disabled":!e.enableStoring},nativeOn:{click:function(t){return e.storeProject.apply(null,arguments)}}},[e._v("\n              "+e._s(e.$t("store"))+"\n            ")])],1)],1)])])}}])}),e._v(" "),e.showInitiateDelete?n("DeleteProject",{attrs:{"initiate-delete":e.initiateDelete,"project-name":e.projectData.name},on:{closeModal:e.handleCloseDelete}}):e._e()],1)}),[],!1,null,null,null)),N={name:"PageEditProject",components:{EditProject:$.exports,SegmentHeader:r.a}},R=Object(S.a)(N,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("SegmentHeader",{attrs:{"with-onboarding":!0}}),e._v(" "),n("EditProject")],1)}),[],!1,null,null,null);t.default=R.exports}}]);