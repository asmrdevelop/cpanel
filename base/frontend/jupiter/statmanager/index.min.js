!function(){"use strict";function e(e){e.preventDefault();var t=PAGE.session+"/execute/StatsManager/save_configuration",r=function(){var e={};return PAGE.analyzerNames.forEach((function(n){$(".check-"+n).each((function(){var n=$(this).attr("name").split("--"),c=$(this).prop("checked"),i=n[0],t=n[1];"object"!=typeof e[i]&&(e[i]={domain:i,analyzers:[]}),e[i].analyzers.push({name:t,enabled:c?1:0})}))})),{changes:Object.values(e)}}();$("#save-spinner").show(),$("#save").prop("disabled",!0);var a=$("#response");return a.hide(),function(e,n){return fetch(e,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}))}(t,r).then((function(e){var t,r;$("#save-spinner").hide(),$("#save").prop("disabled",!1),e.status?(r="success",t=function(e,n){var c=document.getElementById("success-template").innerHTML;return Handlebars.compile(c)({id:n,message:e})}(PAGE.saveSuccess,r)):(r="failure",t=c(PAGE.saveFailed,r)),e.data.forEach((function(e){var n="#check-"+e.domain+"-";e.analyzers.forEach((function(e){var c=n+e.name;$(c).prop("checked",!!e.enabled)}))})),PAGE.analyzerNames.forEach((function(e){i(e)})),a.html(t),n(a,r),a.show()})).catch((function(){$("#save-spinner").hide(),$("#save").prop("disabled",!1);var e=$("#response"),i="network-failure",t=c(PAGE.networkFailed,i);e.html(t),n(e,i),e.show()})),!1}function n(e,n){$("#"+n+"-close").click((function(n){e.hide(),e.html("")}))}function c(e,n){var c=document.getElementById("error-template").innerHTML;return Handlebars.compile(c)({id:n,message:e})}function i(e){var n=function(e){var n=!0;return e.each((function(e,c){n=n&&$(c).prop("checked")})),n}($("input.check-"+e+":checkbox"));$("#check-all-"+e).prop("checked",n)}function t(){$(".check-all").click((function(){var e=$(this).attr("id").replace(/^check-all-/,"");$("input.check-"+e+":checkbox").prop("checked",this.checked)})),PAGE.analyzerNames.forEach((function(e){i(e),$(".check-"+e).click((function(){i(e)}))})),$("#the_form").submit(e)}$(document).ready((function(){window.Promise&&window.fetch?t():function(e,n){var c={},i=function(){window.defineHide&&(window.define=window.defineHide,delete window.defineHide)},t=function(t){var r=0,a=!1;for(var o in e)if(e.hasOwnProperty(o)){var s=e[o];!0===c[s]?r++:c[s]instanceof Error&&(a||(a=!0,i(),n(c[s])))}r===e.length&&(a||(a=!0,i(),n()))},r=function(e){return function(){c[e]=!0,t()}},a=function(e){return function(){c[e]=new Error("Failed to load script "+e),t()}};for(var o in window.define&&(window.defineHide=window.define,window.define=null),e)if(e.hasOwnProperty(o)){var s=e[o],d=document.createElement("script");d.src=s,d.onload=r(s),d.onerror=a(s),document.head.appendChild(d)}}(PAGE.polyfills,t)}))}();