!function(e){"use strict";var t,i=e.LOCALE,r=e.CPANEL,o=e.YAHOO,n=o.util.Dom,c=o.util.Event,s=e.CPANEL.PAGE,a=e.Handlebars,l={};if(s.lists&&s.lists.length)for(var p=s.lists.length-1;p>=0;p--)l[s.lists[p].list]=s.lists[p];var u={advertised:!1,archive_private:!0,subscribe_policy:["3","2"]};function _(e,t,i){var o=i.dialog,n=r.dom.get_data_from_form(o.form,{include_unchecked_checkboxes:0});n.list=i.list,r.api({version:3,module:"Email",func:"set_list_privacy_options",data:n,callback:r.ajax.build_page_callback((function(){i.onSuccess.call(),o.destroy()}),{on_error:o.destroy.bind(o)})})}function v(){var e=n.getAncestorByTagName(this,"form"),t=r.dom.get_data_from_form(e);for(var i in u)if("checkbox"===e[i].type)e[i].checked=u[i];else{var c=u[i];o.lang.isArray(c)||(c=[c]),-1===c.indexOf(t[i])&&r.dom.set_form_el_value(e[i],c[0])}d("private")}function d(e){n.get("form_access_type").innerHTML=s.translated_access_type[e]}function m(e,t){var i,n="private",c=r.dom.get_data_from_form(t);for(var s in u)if(u.hasOwnProperty(s)){i="checkbox"===t[s].type?!!c[s]:c[s];var a=u[s];if(o.lang.isArray(a)?-1===a.indexOf(i)&&(n="public"):i!==a&&(n="public"),"public"===n)break}d(n)}function f(e,t){setTimeout((function(){m(0,t)}),1)}o.lang.augmentObject(e,{privacy_opts_popup:function(e,o,s){t||(t=a.compile(n.get("change_list_privacy_template").text.trim()));var l=new r.ajax.Common_Dialog(null,{close:!0,show_status:!0,status_html:i.maketext("Saving …")});l.setHeader(r.widgets.Dialog.applyDialogHeader(i.maketext("Edit Privacy Options: “[_1]”",e.list.html_encode())));var p=e,u=String(p.subscribe_policy);l.form.innerHTML=t({advertised:"1"===String(p.advertised),archive_private:"1"===String(p.archive_private),subscribe_policy_is_1:"1"===u,subscribe_policy_is_2:"2"===u,subscribe_policy_is_3:"3"===u}),l.submitEvent.subscribe(_,{list:e.list.html_encode(),dialog:l,onSuccess:s}),l.show_from_source(o),m(0,l.form),c.on(l.form,"change",m,l.form),c.on(l.form,"reset",f,l.form);var d=r.Y(l.form).one(".set-private-values");c.on(d,"click",v)}}),s.notice&&(s.noticeHandle=new r.widgets.Page_Notice(s.notice))}(window),define(["angular","cjt/modules"],(function(e){"use strict";return e.module("App",["ui.bootstrap","cjt2.cpanel"]),require(["cjt/directives/toggleSortDirective","cjt/directives/spinnerDirective","cjt/directives/searchDirective","cjt/directives/pageSizeDirective","app/services/mailingListsService","app/controllers/mailingListsController","app/controllers/mainController","uiBootstrap"],(function(){var t=e.module("App");function i(e){var t=this;i.prototype.closed=function(){e.getLists()},i.prototype.open=function(e,i){window.privacy_opts_popup(e,i.currentTarget,t.closed)}}t.filter("escape",(function(){return window.escape})),i.$inject=["mailingListsService"],t.controller("PrivacyWindowController",i),t.init=function(){var i=e.element("#content");return null!==i[0]&&e.bootstrap(i[0],["App"]),t},t.init()}))}));