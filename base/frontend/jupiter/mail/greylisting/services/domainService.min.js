define(["angular","lodash","cjt/util/locale","cjt/io/api","cjt/io/uapi-request","cjt/io/uapi","cjt/services/APIService"],(function(e,t,r,i,a,n){e.module("App").factory("DomainService",["$q","APIService",function(r,i){function n(e){var r=[];if(e.data){for(var i=e.data,a=0,n=i.length;a<n;a++)r.push(i[a]);var s=e.meta,o=s.paginate.total_records||i.length,l=s.paginate.total_pages||1,c=0,d=0;if(s.hasOwnProperty("cPGreyList"))c=s.cPGreyList.total_enabled,d=s.cPGreyList.total_disabled;else{var u=t.filter(i,(function(e){return!!e.enabled}));c=u?u.length:0,d=i.length-c}return{items:r,totalItems:o,totalPages:l,totalEnabled:c,totalDisabled:d}}return{items:[],totalItems:0,totalPages:0,totalEnabled:0,totalDisabled:0}}function s(e,t){var r=new a.Class;return r.initialize("cPGreyList",e,{domains:t}),this.deferred(r,{done:function(e,t){var r=n(e=e.parsedResponse);e.status?t.resolve(r):t.reject({items:r.items,error:e.error})}}).promise}function o(e){var t=new a.Class;return t.initialize("cPGreyList",e),this.deferred(t,{done:function(e,t){var r=n(e=e.parsedResponse);e.status?t.resolve(r):(r.error=e.error,t.reject(r))}}).promise}var l=function(){};return l.prototype=new i,e.extend(l.prototype,{fetchList:function(e){var t=new a.Class;return t.initialize("cPGreyList","list_domains"),e&&(e.sortBy&&e.sortDirection&&t.addSorting(e.sortBy,e.sortDirection,e.sortType),e.pageNumber&&t.addPaging(e.pageNumber,e.pageSize||10),e.filterBy&&e.filterCompare&&e.filterValue&&t.addFilter(e.filterBy,e.filterCompare,e.filterValue)),this.deferred(t,{transformAPISuccess:n}).promise},prepareList:function(e){return n(e)},enableDomains:function(e){return s.call(this,"enable_domains",e)},enableAllDomains:function(){return o.call(this,"enable_all_domains")},disableDomains:function(e){return s.call(this,"disable_domains",e)},disableAllDomains:function(){return o.call(this,"disable_all_domains")}}),new l}])}));