define(["angular","lodash","cjt/util/locale","cjt/io/api","cjt/io/uapi-request","cjt/io/uapi","cjt/services/APIService","cjt/services/viewNavigationApi"],(function(e,t,r,n,a,i){"use strict";var d=e.module("cpanel.zoneEditor.services.dnssec",["cjt2.services.api"]),o=31536e3;return d.factory("DnsSecService",["$q","APIService","viewNavigationApi",function(n,i,d){var u=function(){};return u.prototype=new i,e.extend(u.prototype,{generate:function(e,t,r,i){var d=new a.Class;d.initialize("DNSSEC","enable_dnssec"),d.addArgument("domain",e),void 0!==t&&d.addArgument("algo_num",t);void 0!==r&&d.addArgument("key_setup",r);void 0!==i&&d.addArgument("active",i?1:0);return this.deferred(d).promise.then((function(t){return t.data&&t.data.failed?n.reject(t.data.failed[e]):t.data}))},fetch:function(e){var r=new a.Class;return r.initialize("DNSSEC","fetch_ds_records"),r.addArgument("domain",e),this.deferred(r).promise.then((function(r){return r.data[e].keys?t.chain(r.data[e].keys).orderBy(["key_type","active",function(e){return Number(e.key_tag)}],["asc","desc","asc"]).value():[]}))},activate:function(e,t){var r=new a.Class;return r.initialize("DNSSEC","activate_zone_key"),r.addArgument("domain",e),r.addArgument("key_id",t),this.deferred(r).promise.then((function(e){return e.data.error?n.reject(e.data.error):e.data}))},deactivate:function(e,t){var r=new a.Class;return r.initialize("DNSSEC","deactivate_zone_key"),r.addArgument("domain",e),r.addArgument("key_id",t),this.deferred(r).promise.then((function(e){return e.data.error?n.reject(e.data.error):e.data}))},remove:function(e,t){var r=new a.Class;return r.initialize("DNSSEC","remove_zone_key"),r.addArgument("domain",e),r.addArgument("key_id",t),this.deferred(r).promise.then((function(e){return e.data.error?n.reject(e.data.error):e.data}))},importKey:function(e,t,r){var i=new a.Class;return i.initialize("DNSSEC","import_zone_key"),i.addArgument("domain",e),i.addArgument("key_data",r),i.addArgument("key_type",t.toLocaleLowerCase("en-US")),this.deferred(i).promise.then((function(e){return e.data.error?n.reject(e.data.error):e.data}))},exportKey:function(e,t){var r=new a.Class;return r.initialize("DNSSEC","export_zone_key"),r.addArgument("domain",e),r.addArgument("key_id",t),this.deferred(r).promise.then((function(e){return e.data}))},exportPublicDnsKey:function(e,t){var r=new a.Class;return r.initialize("DNSSEC","export_zone_dnskey"),r.addArgument("domain",e),r.addArgument("key_id",t),this.deferred(r).promise.then((function(e){return 1!==e.data.success&&"1"!==e.data.success?n.reject(e.data.error):e.data}))},copyTextToClipboard:function(e){var t=document.createElement("textarea");if(t.value=e,document.body.appendChild(t),t.select(),!document.execCommand("copy"))throw r.maketext("Copy failed.");document.body.removeChild(t)},goToInnerView:function(e,t,r){var n="/dnssec/"+e,a={domain:t};r&&(a.keyid=r);return d.loadView(n,a)},getSuggestedKeyRotationDate:function(e,t){"string"==typeof e&&(e=Number(e));var r=e;"zsk"===t.toLowerCase()?r+=15768e3:r+=o;return r}}),new u}])}));