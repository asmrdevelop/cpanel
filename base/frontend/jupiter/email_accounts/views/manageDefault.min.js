define(["angular","lodash","cjt/util/locale","cjt/util/parse","uiBootstrap","app/services/emailAccountsService","app/filters/encodeURIComponent","cjt/services/alertService","cjt/directives/alert","cjt/directives/alertList","cjt/directives/actionButtonDirective","cjt/directives/toggleSwitchDirective","cjt/directives/toggleLabelInfoDirective","cjt/directives/validationContainerDirective","cjt/directives/validationItemDirective"],(function(e,a,s,o){"use strict";var t=e.module("cpanel.emailAccounts");return t.value("PAGE",PAGE),t.controller("ManageDefaultController",["$scope","$location","emailAccountsService","PAGE","alertService","$q",function(e,t,l,i,c,n){var r,d,u,m=this;m.isLoading=!0,m.isRTL=i.isRTL,e.showAllHelp=!1,m.email=i.mainEmailAccount,m.webmailEnabled=o.parseBoolean(i.webmailEnabled),m.emailDiskUsageEnabled=i.emailDiskUsageEnabled,m.defaultAddressEnabled=i.defaultAddressEnabled,m.dprefix=i.dprefix,m.examplePlusAddress=a.escape(m.email)+"+plusaddress@"+i.hostname,m.toggleHelp=function(){e.showAllHelp=!e.showAllHelp,e.$broadcast("showHideAllChange",e.showAllHelp)},m.toggleSharedAddressBookStatus=function(){return m.shareAddressBook=!m.shareAddressBook,m.shareAddressBook?l.enableSharedAddressBook().then((function(e){c.add({type:"success",message:s.maketext("All of your email accounts can access the system-managed [output,em,Shared Address Book]."),closeable:!0,replace:!1,autoClose:1e4,group:"emailAccounts"})}),(function(e){c.add({type:"danger",message:e,closeable:!0,replace:!1,group:"emailAccounts"}),m.backToListView()})):l.disableSharedAddressBook().then((function(e){c.add({type:"success",message:s.maketext("Only your default email address can access the system-managed [output,em,Shared Address Book]."),closeable:!0,replace:!1,autoClose:1e4,group:"emailAccounts"})}),(function(e){c.add({type:"danger",message:e,closeable:!0,replace:!1,group:"emailAccounts"}),m.backToListView()}))},m.toggleUTF8MailboxNames=function(){return m.UTF8Mailbox=!m.UTF8Mailbox,m.UTF8Mailbox?l.enableUTF8MailboxNames().then((function(e){c.add({type:"success",message:s.maketext("Mailbox names will now save as [asis,UTF-8]."),closeable:!0,replace:!1,autoClose:1e4,group:"emailAccounts"})}),(function(e){c.add({type:"danger",message:e,closeable:!0,replace:!1,group:"emailAccounts"}),m.backToListView()})):l.disableUTF8MailboxNames().then((function(e){c.add({type:"success",message:s.maketext("Mailbox names will no longer save as [asis,UTF-8]."),closeable:!0,replace:!1,autoClose:1e4,group:"emailAccounts"})}),(function(e){c.add({type:"danger",message:e,closeable:!0,replace:!1,group:"emailAccounts"}),m.backToListView()}))},m.toggleAutoFolderCreation=function(){function e(e){c.add({type:"danger",message:e,closeable:!0,replace:!1,group:"emailAccounts"}),m.backToListView()}function a(e){c.add({type:"success",message:e.message,closeable:!0,replace:!1,autoClose:1e4,group:"emailAccounts"})}return m.autoCreateSubaddressFolders=!m.autoCreateSubaddressFolders,m.autoCreateSubaddressFolders?l.enablePlusAddressFolderCreation(m.email).then(a,e):l.disablePlusAddressFolderCreation(m.email).then(a,e)},m.backToListView=function(){t.path("/list")},r=l.getDefaultAccountUsage().then((function(e){m.diskUsage=e}),(function(e){c.add({type:"danger",message:e,closeable:!0,replace:!1,group:"emailAccounts"}),m.backToListView()})),d=l.isUTF8MailboxNamesEnabled().then((function(e){m.UTF8Mailbox=o.parsePerlBoolean(e.enabled)}),(function(e){c.add({type:"danger",message:e,closeable:!0,replace:!1,group:"emailAccounts"}),m.backToListView()})),u=l.isPlusAddressFolderCreationEnabled(m.email).then((function(e){m.autoCreateSubaddressFolders=o.parsePerlBoolean(e)}),(function(e){c.add({type:"danger",message:e,closeable:!0,replace:!1,group:"emailAccounts"}),m.backToListView()})),n.all([r,!1,d,u]).then((function(){m.isLoading=!1}))}])}));