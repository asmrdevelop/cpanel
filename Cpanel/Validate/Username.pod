
# cpanel - Cpanel/Validate/Username.pod            Copyright 2022 cPanel, L.L.C.
#                                                           All rights reserved.
# copyright@cpanel.net                                         http://cpanel.net
# This code is subject to the cPanel license. Unauthorized copying is prohibited

=head1 NAME

Cpanel::Validate::Username - Utilities for validating user names


=head1 SYNOPSIS

    use Cpanel::Validate::Username;

    if ( !Cpanel::Validate::Username::is_valid( $user ) ) {
        die "Not a valid username!\n";
    }


=head1 DESCRIPTION

Consolidate the code for validating and cleaning user names.

=head1 INTERFACE

=head2 is_strictly_valid( $user )

Return true if C<$user> is a valid username in form. This means that it has
only valid characters and is 1 to 16 characters in length.
Otherwise, return false.

=head2 is_valid( $user )

Return true if C<$user> is a valid username in form. This is a less strict
version of the method above. The length restriction and prohibition about
dashes are both relaxed. Otherwise, return false.

=head2 normalize( $user )

Trims spaces from either end of a potentially valid username and lowercases any
letters. Does not try to force a given string to be valid. Returns the
normalized string.

=head2 scrub( $user )

Tries to convert supplied user string into a valid user name by scrubbing it of
all invalid characters and forcing it to be a legal length by truncating characters
after the 16th. Returns either a valid username or undef if there were no legal
characters.

=head2 reserved_username_check ( $user )

Returns true if provided username is a reserved name that is not usable for regular
accounts, returns false otherwise.

=head2 list_reserved_usernames()

Returns a list of the I<reserved> usernames, or usernames that have some meaning
to the system and users are not allowed to select.

=head2 group_exists ( $user )

Returns true if provided username is associated with an existing group


=head1 DEPENDENCIES

L<Cpanel::StringFunc::Case>
L<Cpanel::Config::LoadCpConf>

=head1 INCOMPATIBILITIES

None reported.

=head1 BUGS AND LIMITATIONS

No bugs have been reported.

=head1 AUTHOR

G. Wade Johnson  C<< wade@cpanel.net >>
Kenneth Power C<< kenp@cpanel.net >>

=head1 LICENSE AND COPYRIGHT

Copyright (c) 2014, cPanel, Inc. All rights reserved.
