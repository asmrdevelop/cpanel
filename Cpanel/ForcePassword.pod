
# cpanel - Cpanel/ForcePassword.pod                Copyright 2022 cPanel, L.L.C.
#                                                           All rights reserved.
# copyright@cpanel.net                                         http://cpanel.net
# This code is subject to the cPanel license. Unauthorized copying is prohibited

=head1 NAME

Cpanel::ForcePassword - Track flag to force password check.

=head1 SYNOPSIS

    use Cpanel::ForcePassword;

    my $fp = Cpanel::ForcePassword->new({ 'user' => 'fred' });
    if ( $fp->need_password_change ) {
        # User needs to change password
    }


=head1 DESCRIPTION

This message

=head1 INTERFACE

The module wraps flags for handling the I<force change password> issue.

=head2 new( $args_hr )

Create a new C<Cpanel::ForcePassword> object. Require a hashref containing the
information to identify the user. Depending on who calls new, some of the
parameters may be optional.

=over 4

=item user

Required user name. This is either a system user or a webmail address.

=item sysuser

This parameter is optional if the I<user> parameter is supplied or if the
the current user is the appropriate system user. If the current user is
root, and the I<user> parameter is a webmail account, this parameter is
required for changing the current force status.

=item homedir

This parameter is optional if a I<sysuser> is specified. If we know the
I<sysuser> this parameter can be looked up.

=back

=head2 $fp->force_password_change

This method adds the current username to the ForcePassword flags.

=head2 $fp->unforce_password_change

This method removes the current username to the ForcePassword flags.

=head2 $fp->need_password_change

The method returns true if the user is flagged to change the password.

=head2 Cpanel::ForcePassword::get_force_password_flags( @users )

This class function takes a list of system users and returns a hash reference
where the users are the keys and the value is true if the user has the force
password status set, and false otherwise.

=head2 Cpanel::ForcePassword::update_force_password_flags( $hashref );

This class function takes a hashref with system users as keys and the required
a value of true if we want to set the force password status, false otherwise.
We iterate through the users and update their status.

In list context, this subroutine returns a list of the users that have been
updated. In scalar context, it returns the number of users that have been
updated.

=head2 api2

Subroutine supplying an api2 interface to the module.

=head1 CONFIGURATION AND ENVIRONMENT

ModName requires no configuration files or environment variables.

=head1 DEPENDENCIES

L<Cpanel::AcctUtils::GetHomeDir>, L<IO::Handle>, and L<Cpanel::SafeFile>

=head1 INCOMPATIBILITIES

None reported.

=head1 BUGS AND LIMITATIONS

No bugs have been reported.

=head1 AUTHOR

G. Wade Johnson  C<< wade@cpanel.net >>

=head1 LICENSE AND COPYRIGHT

Copyright (c) 2010, cPanel, Inc. All rights reserved.
This code is subject to the cPanel license. Unauthorized copying is prohibited
