#!/bin/bash
#
# [% service %]
#
# chkconfig: 2345 [% start_prio %] [% stop_prio %]
# description: [% service %]

[%- IF pidfile.defined and pidfile.length > 0 %]
. /etc/init.d/cpfunctions

USER=[% user %]
SERVICE=[% service %]
PIDFILE=[% pidfile %]
REGEX='[% regex %]'
[% END -%]

start() {
[%- IF pidfile.defined and pidfile.length > 0 %]
    already_running $USER $SERVICE $PIDFILE $REGEX; RUNNING=$?
    if [ 0 = $RUNNING ]; then
        [% start %]
    fi
[% ELSE %]
    [% start %]
[% END -%]
}

stop() {
    [% stop %]
}

status() {
    [% status %]
}

case "$1" in
    start)
        start
        ;;
    stop)
        stop
        ;;
    restart)
        stop
        start
        ;;
    status)
        status
        ;;
esac

