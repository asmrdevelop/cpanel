[%# Available NOTICE keys



%]

[%

    PROCESS "include/colors.tmpl";
    PROCESS "include/icons.tmpl";
    PROCESS "include/styles.tmpl";
    PROCESS "include/code_standout.tmpl";
    PROCESS 'include/zebra_table.tmpl';
    WRAPPER 'wrapper/main.html.tmpl';


    NOTICE.email_reason = CPANEL.locale.maketext('The “[_1]” service reached its memory limit while it accessed mail for the account “[_2]”.', NOTICE.service, NOTICE.account);

    SET zebra_stripe = 0;
%]
      [% SET maximum_mail_process_size_text = CPANEL.locale.maketext('Maximum Size of a Mail Process'); %]

    <p>
        [% CPANEL.locale.maketext('When the “[_1]” service reaches its memory limit, the system performance will suffer because the service must start a new process and it will lose all of the data that it has cached in memory.', NOTICE.service); %]
    </p>

    <p>
        [% CPANEL.locale.maketext('You should increase the current memory limit of “[format_bytes,_1]” or remove any unwanted email from the “[_2]” account. To increase the memory limit, use the “[_3]” setting in the “[output,url,_4,Mailserver Configuration]” interface in WHM.', NOTICE.current_memory_limit*1024*1024, NOTICE.account, maximum_mail_process_size_text, NOTICE.whm_mailserver_config_url); %]
    </p>

     <p>
        [% CPANEL.locale.maketext('To increase the memory limit from the command line, use the following command:') %]
        [% SET command_text = "whmapi1 set_service_config_key service=dovecot key=mail_process_size value=" _ (NOTICE.current_memory_limit * 2); %]
        [% code_standout(command=command_text) %]
        [% SET command_text = "whmapi1 restartservice service=imap"; %]
        [% code_standout(command=command_text) %]

    </p>


    <p>
        [% CPANEL.locale.maketext('To remove all email older than one year from this account’s Junk folder via the command line, use the following command:') %]
        [% code_standout(command="whmapi1 expunge_mailbox_messages account=" _ NOTICE.account _ ' mailbox=INBOX.Junk query=' _ "'savedbefore 52w'") %]

        [% CPANEL.locale.maketext('To remove all email older than one year from this account’s INBOX via the command line, use the following command:') %]
        [% code_standout(command="whmapi1 expunge_mailbox_messages account=" _ NOTICE.account _ ' mailbox=INBOX query=' _ "'savedbefore 52w'") %]
    </p>


    <h4>[% CPANEL.locale.maketext('Usage report for the “[_1]” account:', NOTICE.account); %]</h4>
    [%
      mailbox_table_items = [];

      FOREACH mailbox IN NOTICE.mailbox_status;

          mailbox_table_items.push([
              mailbox.key,
              CPANEL.locale.format_bytes(mailbox.value.vsize),
              CPANEL.locale.numf(mailbox.value.messages),
          ]);
      END;

     zebra_table(
        titles = [
            CPANEL.locale.maketext("Mailbox"),
            CPANEL.locale.maketext("Size"),
            CPANEL.locale.maketext("Message Count"),
        ],
        items = mailbox_table_items,
      );

    %]
    <p>
        [% CPANEL.locale.maketext('To get an updated report for this account from the command line, use the following command:') %]
        [% code_standout(command="whmapi1 get_mailbox_status account=" _ NOTICE.account) %]
    </p>
    [% END %]
