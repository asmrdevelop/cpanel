#!/usr/local/cpanel/3rdparty/bin/perl
# cpanel - bin/spf_updater                           Copyright 2022 cPanel L.L.C.
#                                                           All rights reserved.
# copyright@cpanel.net                                         http://cpanel.net
# This code is subject to the cPanel license. Unauthorized copying is prohibited

use strict;
use warnings;

use Cpanel::SPF::Update        ();
use Cpanel::AcctUtils::Account ();

if ( !@ARGV || $ARGV[0] =~ /^-/ ) {
    die "$0: usage: $0 <user1> [<user2> ...]";
}

for (@ARGV) {
    if ( !Cpanel::AcctUtils::Account::accountexists($_) ) {
        die "Account doesn't exist: $_\n";
    }
}

Cpanel::SPF::Update::update_spf_records( 'users' => [@ARGV] );
