var form=angular.module("formUtilities",[]);form.directive("openform",function(){return function(scope,element){element.click(function(e){var form=element[0].form;if($(form).hasClass("closed-form")){e.preventDefault()}$(form).removeClass("closed-form")})}});form.directive("closeform",function(){return function(scope,element){element.click(function(){var form=element[0].form,formName=$(form).attr("name");$(form).addClass("closed-form");form.reset();scope[formName].$setPristine()})}});form.directive("ipv6cidr",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attr,ctrl){ctrl.$parsers.unshift(function(value){var range=value.split("/"),prefix=range[1],address=range[0],collapsed=address.match(/::/g),segments=address.split(":"),i;if(collapsed){scope.ipv6Collapsed=collapsed.length>1||/:{3,}/.test(address)?false:"valid"}else{scope.ipv6Collapsed="valid"}if(segments){var length=segments.length,valid128=length===8&&segments[length-1]!=="",validCollapsed=false;if(collapsed){validCollapsed=length>2&&collapsed.length===1}if(valid128&&prefix>=16){for(i=Math.floor((Number(prefix)+15)/16);i<8;i++){if(!/^0{1,4}$/.test(segments[i])){valid128=false}}}if(valid128||validCollapsed){scope.ipv6Address="valid"}else{scope.ipv6Address=false}var invalidLengthFound=false,invalidCharactersFound=false;for(i=0;i<length;i++){var segment=segments[i],segmentLength=segment.length;if(segmentLength>0){if(!invalidCharactersFound){scope.ipv6Characters=/[^0-9a-f]/i.test(segment)?false:"valid"}if(!invalidLengthFound){scope.ipv6SegmentLength=segmentLength>4?false:"valid"}}if(scope.ipv6Characters===false){invalidCharactersFound=true}if(scope.ipv6SegmentLength===false){invalidLengthFound=true}}}else{scope.ipv6Characters="valid";scope.ipv6Address=false}if(prefix){scope.ipv6Range=/\D/.test(prefix)||prefix<1||prefix>128?false:"valid"}else{scope.ipv6Range=false}if(scope.ipv6Collapsed&&scope.ipv6Address&&scope.ipv6Characters&&scope.ipv6SegmentLength&&scope.ipv6Range){ctrl.$setValidity("ipv6cidr",true);return value}else{ctrl.$setValidity("ipv6cidr",false);return false}})}}});