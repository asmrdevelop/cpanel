"use strict";(self.webpackChunkcpanel_cloud=self.webpackChunkcpanel_cloud||[]).push([[179],{6257:(g,C,l)=>{var x=l(1481),e=l(6738),c=l(6895),k=l(348),f=l(838),h=l(269),D=l(5529),y=l(1086),N=l(7221),M=l(567),d=l(4850),U=l(8635);const H=window?.PAGE?.base??"",Y=window?.PAGE?.securityToken??"",E=(0,U.s)(window?.PAGE?.locale_is_rtl),b=new e.OlP("RTLInjectionToken"),v=new e.OlP("SecurityTokenInjectionToken"),S=new e.OlP("RedirectInjectionToken");var m=l(8946),p=l(7709);class V{constructor(s){this.comment=s.comment,this.host=s.host,this.localPath=s.local_path,this.options=s.options.join(" "),this.remotePath=s.remote_path,this.revision=s.revision,this.type=s.type}}var F=l(802);let w=(()=>{class n{constructor(t){this._apiClient=t}createFilesystemConfiguration(t){const o=new m.r(m.N.JsonApi,{method:"PRIVATE_add_nfs_storage",arguments:[new p.h("host",t.hostnameOrIP),new p.h("remote_path",t.exportPath),new p.h("comment",t.userNotes)]});return t.mountOptions.split(" ").forEach((i=>{i.length&&o.addArgument({name:"option",value:i})})),this._apiClient.post(o).pipe((0,d.U)(this._parseTypedResponse))}getFilesystemConfiguration(){const t=new m.r(m.N.JsonApi,{method:"PRIVATE_get_remote_storage"});return this._apiClient.post(t).pipe((0,d.U)(this._parseTypedResponse),(0,d.U)(this._parseFilesystemData))}unmountFilesystem(t){const o=new m.r(m.N.JsonApi,{method:"PRIVATE_remove_remote_storage",arguments:[new p.h("local_path",t)]});return this._apiClient.post(o).pipe((0,d.U)(this._parseTypedResponse))}updateFilesystemConfiguration(t){const o=new m.r(m.N.JsonApi,{method:"PRIVATE_update_nfs_storage",arguments:[new p.h("local_path",t.localPath),new p.h("revision",t.revision),new p.h("host",t.host),new p.h("remote_path",t.remotePath),new p.h("comment",t.comment)]});return t.options.split(" ").forEach((i=>{i.length&&o.addArgument({name:"option",value:i})})),this._apiClient.post(o).pipe((0,d.U)(this._parseTypedResponse))}_parseFilesystemData(t){return t.data.length?new V(t.data[0]):null}_parseTypedResponse(t){if(t.hasErrors)throw new Error(t.errors[0].message);return t}}return n.ɵfac=function(t){return new(t||n)(e.LFG(F.A4))},n.ɵprov=e.Yz7({token:n,factory:n.ɵfac,providedIn:"root"}),n})(),J=(()=>{class n{constructor(t,o,i){this._locale=t,this._filesystemService=o,this._securityToken=i,this._unconfiguredSteps=[{disabledDescription:this._locale.maketext("Ensure the server is configured to begin configuring a cPanel services cluster."),enabledDescription:this._locale.maketext("Ensure [asis,cPanel] is using a scalable filesystem without a single point of failure."),id:"firstStepComponent",isComplete:!1,isDisabled:!0,title:this._locale.maketext("Attach a Network Storage System"),step:"first",url:`${this._securityToken}/scripts7/cpanel-cloud/initial-filesystem-configuration`},{disabledDescription:this._locale.maketext("You must complete the ‘Attach a Network Storage System’ step before you can add nodes."),enabledDescription:this._locale.maketext("Connect the machines that will handle service redundancy and orchestration."),id:"secondStepComponent",isComplete:!1,isDisabled:!0,title:this._locale.maketext("Add Nodes"),step:"second",url:`${this._securityToken}/scripts7/cpanel-cloud/initial-node-configuration`},{disabledDescription:this._locale.maketext("You must complete the ‘Add Nodes’ step before you can deploy a database."),enabledDescription:this._locale.maketext("Configure the database service, including name and number of replications."),id:"thirdStepComponent",isComplete:!1,isDisabled:!0,title:this._locale.maketext("Deploy a Database"),step:"third",url:"#"},{disabledDescription:this._locale.maketext("You must complete the ‘Add Nodes’ step before you can deploy [asis,DNS]."),enabledDescription:this._locale.maketext("Configure the [asis,DNS] service, including name and number of replications."),id:"fourthStepComponent",isComplete:!1,isDisabled:!0,title:this._locale.maketext("Deploy [asis,DNS]"),step:"fourth",url:"#"}]}get unconfiguredSteps$(){return(0,y.of)(this._unconfiguredSteps)}getConfiguredSteps(){const t=this.unconfiguredSteps$,o=this._filesystemService.getFilesystemConfiguration();return(0,M.D)({filesystem:o,steps:t,token:(0,y.of)(this._securityToken)}).pipe((0,d.U)(this._setStatus))}_setStatus(t){const o=t.steps,i=!!t.filesystem;return o.forEach((a=>{"first"===a.step&&(a.isDisabled=!1,a.isComplete=i,a.url=a.isComplete?`${t.token}/scripts7/cpanel-cloud/manage-filesystem-configuration`:a.url),"second"===a.step&&(a.isDisabled=!i)})),o}}return n.ɵfac=function(t){return new(t||n)(e.LFG(h.g),e.LFG(w),e.LFG(v))},n.ɵprov=e.Yz7({token:n,factory:n.ɵfac,providedIn:"root"}),n})();var r=l(3063);function q(n,s){1&n&&e.GkF(0)}function B(n,s){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,q,1,0,"ng-container",5),e.qZA()),2&n){e.oxw();const t=e.MAs(4);e.xp6(1),e.Q6J("ngTemplateOutlet",t)}}function G(n,s){1&n&&e.GkF(0)}function R(n,s){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,G,1,0,"ng-container",5),e.qZA()),2&n){e.oxw();const t=e.MAs(6);e.xp6(1),e.Q6J("ngTemplateOutlet",t)}}const Q=function(n){return{complete:n}};function W(n,s){if(1&n&&(e.TgZ(0,"a",7)(1,"div",8)(2,"div",9),e._UZ(3,"i",10),e.TgZ(4,"div")(5,"p",11)(6,"strong"),e._uU(7),e.qZA()(),e.TgZ(8,"p",12),e._uU(9),e.qZA()()()()()),2&n){const t=e.oxw();e.s9C("href",t.url,e.LSH),e.xp6(3),e.Q6J("ngClass",e.VKq(4,Q,t.isComplete)),e.xp6(4),e.Oqu(t.title),e.xp6(2),e.Oqu(t.enabledDescription)}}function $(n,s){if(1&n&&(e.TgZ(0,"div",13)(1,"div",9),e._UZ(2,"i",14),e.TgZ(3,"div")(4,"p",11)(5,"strong"),e._uU(6),e.qZA()(),e.TgZ(7,"p",12),e._uU(8),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(6),e.Oqu(t.title),e.xp6(2),e.Oqu(t.disabledDescription)}}let j=(()=>{class n{}return n.ɵfac=function(t){return new(t||n)},n.ɵcmp=e.Xpm({type:n,selectors:[["cp-cloud-setup-step"]],inputs:{disabledDescription:"disabledDescription",enabledDescription:"enabledDescription",id:["stepID","id"],isComplete:"isComplete",isDisabled:"isDisabled",title:"title",url:"url"},decls:7,vars:2,consts:[[1,"setupStep"],[4,"ngIf"],["class","disabled",4,"ngIf"],["enabledStep",""],["disabledStep",""],[4,"ngTemplateOutlet"],[1,"disabled"],[3,"href"],[1,"panel","panel-default"],[1,"wordsContainer","panel-body"],[1,"fas","fa-solid","fa-check",3,"ngClass"],[1,"stepTitle"],[1,"stepDescription"],[1,"panel","panel-default","disabledStep"],[1,"fas","fa-solid","fa-check"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.YNc(1,B,2,1,"div",1),e.YNc(2,R,2,1,"div",2),e.qZA(),e.YNc(3,W,10,6,"ng-template",null,3,e.W1O),e.YNc(5,$,9,2,"ng-template",null,4,e.W1O)),2&t&&(e.xp6(1),e.Q6J("ngIf",!o.isDisabled),e.xp6(1),e.Q6J("ngIf",o.isDisabled))},directives:[c.O5,c.tP,c.mk],styles:["a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:hover{text-decoration:none}i[_ngcontent-%COMP%]{background-color:var(--bs-gray-600);border-radius:100%;color:var(--cp-secondary-background);padding:var(--cp-spacer-2);margin:var(--cp-spacer-3)}.complete[_ngcontent-%COMP%]{background-color:var(--cp-success-color)}.stepTitle[_ngcontent-%COMP%], .stepDescription[_ngcontent-%COMP%]{color:var(--bs-gray-700)}.wordsContainer[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.disabledStep[_ngcontent-%COMP%]   .stepTitle[_ngcontent-%COMP%], .disabledStep[_ngcontent-%COMP%]   .stepDescription[_ngcontent-%COMP%]{color:var(--cp-disabled-color)}.disabledStep[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{background-color:var(--cp-disabled-color)}.disabledStep[_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),n})();function z(n,s){1&n&&e.GkF(0)}const A=function(n){return{$implicit:n}};function X(n,s){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,z,1,0,"ng-container",7),e.qZA()),2&n){const t=s.ngIf;e.oxw(3);const o=e.MAs(5);e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(2,A,t))}}function K(n,s){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,X,2,4,"div",5),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,t.unconfiguredSteps$))}}function ee(n,s){if(1&n&&e._UZ(0,"cp-loading-spinner",8),2&n){const t=e.oxw(2);e.Q6J("id",t.spinnerID)}}function te(n,s){if(1&n&&(e.YNc(0,K,3,3,"div",3),e.ALo(1,"async"),e.YNc(2,ee,1,1,"ng-template",null,4,e.W1O)),2&n){const t=e.MAs(3),o=e.oxw();e.Q6J("ngIf",e.lcZ(1,2,o.loadingError$))("ngIfElse",t)}}function ne(n,s){1&n&&e.GkF(0)}function oe(n,s){if(1&n&&(e.TgZ(0,"div",9),e.YNc(1,ne,1,0,"ng-container",7),e.qZA()),2&n){const t=s.ngIf;e.oxw();const o=e.MAs(5);e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(2,A,t))}}function se(n,s){if(1&n&&(e.TgZ(0,"div"),e._UZ(1,"cp-cloud-setup-step",16),e.qZA()),2&n){const t=s.$implicit;e.xp6(1),e.Q6J("disabledDescription",t.disabledDescription)("enabledDescription",t.enabledDescription)("stepID",t.id)("isComplete",t.isComplete)("isDisabled",t.isDisabled)("title",t.title)("url",t.url)}}function ie(n,s){if(1&n&&(e.TgZ(0,"div",10)(1,"div",11),e._uU(2),e.qZA(),e._UZ(3,"div",12),e.qZA(),e.TgZ(4,"div",13)(5,"p",14),e._uU(6),e.qZA(),e.YNc(7,se,2,7,"div",15),e.qZA()),2&n){const t=s.$implicit,o=e.oxw();e.xp6(2),e.hij(" ",o.title," "),e.xp6(4),e.Oqu(o.welcomeMessage),e.xp6(1),e.Q6J("ngForOf",t)}}let le=(()=>{class n{constructor(t,o,i){this._alertService=t,this._stepsService=o,this.locale=i,this.loadingError$=new D.xQ,this._setInterfaceText(),this.unconfiguredSteps$=this._stepsService.unconfiguredSteps$}get spinnerID(){return"clusterStepsSpinner"}ngOnInit(){this.stepsConfig$=this._stepsService.getConfiguredSteps().pipe((0,N.K)((t=>(this.loadingError$.next(!0),this._alertService.error(t),(0,y.of)(!1)))))}_setInterfaceText(){this.welcomeMessage=this.locale.maketext("Welcome! It looks like you haven’t finished setting up your cPanel services cluster. Complete the steps below to configure your filesystem, nodes, and services."),this.title=this.locale.maketext("Configuration Steps")}}return n.ɵfac=function(t){return new(t||n)(e.Y36(r.c9),e.Y36(J),e.Y36(h.g))},n.ɵcmp=e.Xpm({type:n,selectors:[["cp-cloud-cpsc-setup-steps"]],decls:6,vars:4,consts:[["loadingOrError",""],["class","panel panel-default","id","configuredStepsPanel",4,"ngIf","ngIfElse"],["stepsTemplate",""],[4,"ngIf","ngIfElse"],["loading",""],["class","panel panel-default","id","unconfiguredStepsPanel",4,"ngIf"],["id","unconfiguredStepsPanel",1,"panel","panel-default"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"id"],["id","configuredStepsPanel",1,"panel","panel-default"],[1,"panel-heading"],[1,"widget-title","pull-left","flip"],[1,"clearfix"],[1,"panel-body"],[1,"welcomeMessage"],[4,"ngFor","ngForOf"],[3,"disabledDescription","enabledDescription","stepID","isComplete","isDisabled","title","url"]],template:function(t,o){if(1&t&&(e.YNc(0,te,4,4,"ng-template",null,0,e.W1O),e.YNc(2,oe,2,4,"div",1),e.ALo(3,"async"),e.YNc(4,ie,8,3,"ng-template",null,2,e.W1O)),2&t){const i=e.MAs(1);e.xp6(2),e.Q6J("ngIf",e.lcZ(3,2,o.stepsConfig$))("ngIfElse",i)}},directives:[c.O5,c.tP,r.go,c.sg,j],pipes:[c.Ov],styles:[".setupStepsContainer[_ngcontent-%COMP%]{border:var(--cp-border-width-2) solid var(--bs-black-rgb)}"]}),n})();var u=l(4006),_=l(2502),P=l(4879);const re=["\\","?","%","*",":","|",'"',"<",">"],ae=/^[a-zA-Z0-9]([a-zA-Z0-9-]*[a-zA-Z0-9])?$/;let ce=(()=>{class n{constructor(t){this._locale=t}isValidAbsolutePath(){return t=>this._isAbsoluteFilepath(t.value)?null:{exportPath:{value:t.value,message:this._locale.maketext("Invalid absolute filepath.")}}}isValidUserNote(){return t=>_.TW.validate()(t.value)||null}isValidHostnameOrIP(){return t=>{let o=this._isValidHostname(t.value);return o||(o=this._isValidIP(t.value),o)?null:{hostnameOrIP:{value:t.value,message:this._locale.maketext("Invalid hostname or [asis,IP] address.")}}}}matchesPattern(t,o){return i=>t.test(i.value)?null:{mountOptions:{value:i.value,message:o}}}_isAbsoluteFilepath(t){if(0!==t.indexOf("/"))return!1;for(const o of t.substring(1).split("/"))if(!o.length||"."===o||".."===o)return!1;return!re.some((o=>t.includes(o)))}_isValidHostname(t){const o=t.split(".");if(t.length>254||P.default.toASCII(t).length>254||o.length<2)return!1;for(const i of o)if(!ae.test(i)||0===i.length||i.length>63||P.default.toASCII(i).length>63)return!1;return!0}_isValidIP(t){return!_.Xz.anyIP()({value:t})}}return n.ɵfac=function(t){return new(t||n)(e.LFG(h.g))},n.ɵprov=e.Yz7({token:n,factory:n.ɵfac,providedIn:"root"}),n})();var T=l(537);let ue=(()=>{class n{}return n.ɵfac=function(t){return new(t||n)},n.ɵcmp=e.Xpm({type:n,selectors:[["cp-cloud-validation-warning"]],inputs:{warning:"warning"},decls:4,vars:2,consts:[[1,"validation-container"],[1,"validation","validation-warning","ng-hide"],[1,"fas","fa-exclamation-circle"],[1,"validation-message",3,"innerHtml"]],template:function(t,o){1&t&&(e.TgZ(0,"ul",0)(1,"li",1),e._UZ(2,"i",2)(3,"span",3),e.qZA()()),2&t&&(e.xp6(1),e.uIk("id",o.warning.id),e.xp6(2),e.Q6J("innerHtml",o.warning.message,e.oJD))},styles:[".validation-container[_ngcontent-%COMP%]{background-color:var(--cp-warning-background-light);border:var(--cp-border-width-1) solid var(--cp-warning-border-color);margin-bottom:var(--cp-spacer-4)}"]}),n})();function pe(n,s){if(1&n&&e._UZ(0,"cp-loading-spinner",2),2&n){const t=e.oxw();e.Q6J("id",t.spinnerID)}}function me(n,s){if(1&n&&e._UZ(0,"cp-cloud-validation-warning",34),2&n){const t=e.oxw(2);e.Q6J("warning",t.exportPathValidationWarning)}}function de(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",(function(){return e.CHM(t),e.oxw(2).toggleUnmountFilesystemSection()})),e._uU(1),e.qZA()}if(2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.pageText.unmountFilesystemBtn," ")}}function ge(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"section",36)(1,"cp-form-field",37)(2,"div",13),e._uU(3),e.qZA(),e.TgZ(4,"div",14),e._UZ(5,"input",38),e.qZA()(),e.TgZ(6,"figure")(7,"pre",null,39),e._uU(9),e.qZA(),e.TgZ(10,"button",40),e.NdJ("click",(function(){e.CHM(t);const i=e.MAs(8);return e.oxw(2).copyText(i)})),e._uU(11),e._UZ(12,"i",41),e.qZA()(),e.TgZ(13,"cp-action-button",42),e.NdJ("click",(function(){return e.CHM(t),e.oxw(2).unmountFilesystem()})),e._uU(14),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("showAllHelp",t.showAllHelpVal)("showInfoToggle",t.showInfoToggle)("control",t.filesystemFormGroup.controls.unmountFilesystem)("labelText",t.pageText.unmountFilesystemLabel),e.xp6(2),e.hij(" ",t.pageText.unmountFilesystemHelp," "),e.xp6(6),e.Oqu(t.matchTextForUnmount),e.xp6(2),e.hij(" ",t.pageText.copyMatchText," "),e.xp6(2),e.Q6J("id",t.unmountBtnConfig.id)("buttonClass",t.unmountBtnConfig.buttonClass)("buttonState",t.unmountBtnConfig.buttonState),e.xp6(1),e.hij(" ",t.pageText.unmountFilesystemBtn," ")}}const fe=function(n,s){return{"pull-right":n,"pull-left":s}},he=function(n,s){return{"fa-arrow-left":n,"fa-arrow-right":s}};function _e(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"form",3),e.NdJ("ngSubmit",(function(){return e.CHM(t),e.oxw().submitForm()})),e.TgZ(1,"div",4)(2,"div",5)(3,"div",6),e._uU(4),e.qZA(),e.TgZ(5,"div",7)(6,"button",8),e.NdJ("click",(function(){return e.CHM(t),e.oxw().toggleShowAllHelp()})),e._uU(7),e._UZ(8,"i",9),e.qZA()(),e._UZ(9,"div",10),e.qZA(),e.TgZ(10,"div",11)(11,"cp-form-field",12)(12,"div",13),e._uU(13),e.qZA(),e.TgZ(14,"div",14),e._UZ(15,"input",15),e.qZA()(),e.TgZ(16,"cp-form-field",16)(17,"div",13),e._uU(18),e.qZA(),e.TgZ(19,"div",14),e._UZ(20,"input",17),e.qZA()(),e.YNc(21,me,1,1,"cp-cloud-validation-warning",18),e.TgZ(22,"cp-form-field",19),e._UZ(23,"div",20),e.TgZ(24,"div",14),e._UZ(25,"input",21),e.qZA()(),e.TgZ(26,"cp-form-field",22)(27,"div",13),e._uU(28),e.qZA(),e.TgZ(29,"div",14),e._UZ(30,"textarea",23),e.qZA()(),e.TgZ(31,"cp-callout",24)(32,"span",25),e._uU(33),e.qZA(),e._UZ(34,"p",26),e.TgZ(35,"label"),e._UZ(36,"input",27),e._uU(37),e.qZA()(),e.YNc(38,de,2,1,"button",28),e.YNc(39,ge,15,11,"section",29),e.qZA(),e.TgZ(40,"div",30)(41,"cp-action-button",31),e._uU(42),e.qZA(),e.TgZ(43,"a",32),e._UZ(44,"i",33),e._uU(45),e.qZA(),e._UZ(46,"div",10),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.filesystemFormGroup),e.xp6(4),e.hij(" ",t.pageText.formTitle," "),e.xp6(3),e.hij(" ",t.toggleHelpLabel," "),e.xp6(4),e.Q6J("showAllHelp",t.showAllHelpVal)("showInfoToggle",t.showInfoToggle)("control",t.filesystemFormGroup.controls.hostnameOrIP)("labelText",t.pageText.hostnameOrIPLabel),e.xp6(2),e.hij(" ",t.pageText.hostnameOrIPHelp," "),e.xp6(3),e.Q6J("showAllHelp",t.showAllHelpVal)("showInfoToggle",t.showInfoToggle)("control",t.filesystemFormGroup.controls.exportPath)("labelText",t.pageText.exportPathLabel),e.xp6(2),e.hij(" ",t.pageText.exportPathHelp," "),e.xp6(3),e.Q6J("ngIf",t.showExportPathValidationWarning),e.xp6(1),e.Q6J("showAllHelp",t.showAllHelpVal)("showInfoToggle",t.showInfoToggle)("control",t.filesystemFormGroup.controls.mountOptions)("labelText",t.pageText.mountOptionsLabel),e.xp6(1),e.Q6J("innerHTML",t.pageText.mountOptionsHelp,e.oJD),e.xp6(3),e.Q6J("showAllHelp",t.showAllHelpVal)("showInfoToggle",t.showInfoToggle)("control",t.filesystemFormGroup.controls.userNotes)("labelText",t.pageText.userNotesLabel),e.xp6(2),e.hij(" ",t.pageText.userNotesHelp," "),e.xp6(5),e.Oqu(t.pageText.securityWarningTitle),e.xp6(1),e.Q6J("innerHTML",t.pageText.securityWarningInfo,e.oJD),e.xp6(3),e.hij(" ",t.pageText.securityWarningLabel," "),e.xp6(1),e.Q6J("ngIf",!t.unmountFilesystemSectionVisible&&t.showUnmountFilesystemInput),e.xp6(1),e.Q6J("ngIf",t.unmountFilesystemSectionVisible&&t.showUnmountFilesystemInput),e.xp6(2),e.Q6J("id",t.submitBtnConfig.id)("buttonClass",t.submitBtnConfig.buttonClass)("buttonState",t.submitBtnConfig.buttonState),e.xp6(1),e.Oqu(t.pageText.mountSystemBtn),e.xp6(1),e.s9C("href",t.returnToStepsLink,e.LSH),e.Q6J("ngClass",e.WLB(37,fe,!t.isRTL,t.isRTL)),e.xp6(1),e.Q6J("ngClass",e.WLB(40,he,!t.isRTL,t.isRTL)),e.xp6(1),e.hij(" ",t.pageText.returnToClusterBtn,"")}}let Z=(()=>{class n{constructor(t,o,i,a,we,Ae,Pe,Ie,Oe,Ze){this._alertService=t,this._filesystemService=o,this._formBuilder=i,this._isRTL=a,this._locale=we,this._redirectDelaySeconds=Ae,this._route=Pe,this._router=Ie,this._securityToken=Oe,this._validation=Ze,this.showAllHelpVal=!0,this.showInfoToggle=!0,this.unmountFilesystemSectionVisible=!1,this._submitting=!1,this._unmounting=!1}get currentFormData(){return{hostnameOrIP:this.filesystemFormGroup.get("hostnameOrIP").value,exportPath:this.filesystemFormGroup.get("exportPath").value,mountOptions:this.filesystemFormGroup.get("mountOptions").value,userNotes:this.filesystemFormGroup.get("userNotes").value,securityAccepted:this.filesystemFormGroup.get("securityAccepted").value}}get exportPathValidationWarning(){return{id:"exportPathValidationWarning",message:this._locale.maketext("Confirm that your filepath contains a space character.")}}get isRTL(){return this._isRTL}get pageText(){return{copyMatchText:this._locale.maketext("Copy"),exportPathHelp:this._locale.maketext("Enter the [asis,NFS] export path."),exportPathLabel:this._locale.maketext("Export Path"),formTitle:this._locale.maketext("Attach a Network Storage System"),hideAllHelpLabel:this._locale.maketext("Hide Help Text"),hostnameOrIPHelp:this._locale.maketext("Enter a valid hostname, [asis,IPv4] address, or [asis,IPv6] address for the filesystem service."),hostnameOrIPLabel:this._locale.maketext("Hostname or [asis,IP] Address"),mountOptionsHelp:this._locale.maketext("You can enter additional arguments for configuring your NFS server in the [output,em,Additional Arguments] text box. You can see a list of options by running the [output,em,man 5 nfs] command at the command line. These additional arguments are optional."),mountOptionsLabel:this._locale.maketext("Additional Mount Options"),mountOptionsValidationText:this._locale.maketext("You can only use alphanumeric, equal [asis,(=)], or space characters."),mountSystemBtn:this._locale.maketext("Mount Filesystem"),securityWarningInfo:this._locale.maketext("[asis,cPanel] [output,amp] [asis,WHM] is not responsible for the filesystem service connection, security, or the data passed. Please take appropriate safety measures."),securityWarningLabel:this._locale.maketext("Check here to indicate that you have read, understand, and agree to the security concerns."),securityWarningTitle:this._locale.maketext("Security Concerns"),showAllHelpLabel:this._locale.maketext("Show Help Text"),returnToClusterBtn:this._locale.maketext("Return to cluster setup[comment,button to direct user to the previous interface]"),unmountFilesystemBtn:this._locale.maketext("Unmount Filesystem"),unmountFilesystemHelp:this._locale.maketext("Copy the hostname or [asis,IP] address to the input in order to confirm unmounting."),unmountFilesystemLabel:this._locale.maketext("Enter the hostname or [asis,IP] address of the filesystem."),userNotesHelp:this._locale.maketext("Enter additional notes about the file system. You can view these notes in the list of mounted filesystems."),userNotesLabel:this._locale.maketext("User Notes")}}get returnToStepsLink(){return`${this._securityToken}/scripts7/cpanel-cloud/cpsc-setup-steps`}get showExportPathValidationWarning(){return this.filesystemFormGroup.get("exportPath").value.includes(" ")}get showUnmountFilesystemInput(){return!!this._route.snapshot.data.filesystemPresent}get spinnerID(){return"filesystemConfigSpinner"}get submitBtnConfig(){return{id:"filesystemFormSubmitButton",buttonClass:this._isRTL?"btn-primary pull-right":"btn-primary pull-left",buttonState:this.submitBtnState}}get submitBtnState(){return this._submitting?r.FP.loading:this.filesystemFormGroup.valid?r.FP.enabled:r.FP.disabled}get toggleHelpLabel(){return this.showAllHelpVal?this.pageText.hideAllHelpLabel:this.pageText.showAllHelpLabel}get unmountBtnConfig(){return{id:"filesystemUnmountButton",buttonClass:"btn-danger",buttonState:this.unmountBtnState}}get unmountBtnState(){return this._unmounting?r.FP.loading:this.showUnmountFilesystemInput&&this.filesystemFormGroup.get("hostnameOrIP").value===this.filesystemFormGroup.get("unmountFilesystem").value?r.FP.enabled:r.FP.disabled}copyText(t){navigator.clipboard.writeText(t.textContent).then((()=>{this._alertService.success(this._locale.maketext("Successfully copied text to the clipboard."))})).catch((i=>{this._alertService.error(this._locale.maketext("Copy failed with: [_1]",i))}))}submitForm(){this._submitting=!0,this._filesystemSub$=this._route.snapshot.data.filesystemPresent?this._updateFilesystem():this._addFilesystem()}toggleUnmountFilesystemSection(){this.unmountFilesystemSectionVisible=!this.unmountFilesystemSectionVisible}toggleShowAllHelp(){this.showAllHelpVal=!this.showAllHelpVal}unmountFilesystem(){this._unmounting=!0,this._filesystemSub$=this._filesystemService.unmountFilesystem(this._filesystemData.localPath).pipe((0,T.x)((()=>{this._unmounting=!1}))).subscribe({error:t=>{this._alertService.error(t)},complete:()=>{const t=this._locale.maketext("You have successfully unmounted the network file system. You will be redirected in [quant,_1,second,seconds].",this._redirectDelaySeconds);this._handleSuccess(t,1e3*this._redirectDelaySeconds)}})}ngOnInit(){this._route.snapshot.data.filesystemPresent?this._getFilesystemConfiguration():this._initializeForm()}ngOnDestroy(){this._filesystemSub$&&this._filesystemSub$.unsubscribe()}_addFilesystem(){return this._filesystemService.createFilesystemConfiguration(this.currentFormData).pipe((0,T.x)((()=>{this._submitting=!1}))).subscribe({error:t=>{this._alertService.error(t)},complete:()=>{const t=this._locale.maketext("You have successfully mounted a network file system. You will be redirected in [quant,_1,second,seconds].",this._redirectDelaySeconds);this._handleSuccess(t,1e3*this._redirectDelaySeconds)}})}_getFilesystemConfiguration(){this._filesystemSub$=this._filesystemService.getFilesystemConfiguration().subscribe({next:t=>{this._filesystemData=t,this.matchTextForUnmount=this._filesystemData.host},error:t=>{this._alertService.error(t),this._initializeForm()},complete:()=>{this._initializeForm(this._filesystemData)}})}_handleSuccess(t,o){this._alertService.add(new r.bZ(t,r.NK.success,{autoClosePeriod:o})),setTimeout((()=>{this._router.navigateByUrl(`${this._securityToken}/scripts7/cpanel-cloud/`)}),o)}_initializeForm(t){this.filesystemFormGroup=this._formBuilder.group({hostnameOrIP:[t?.host||"",[_.dt.required(),this._validation.isValidHostnameOrIP()]],exportPath:[t?.remotePath||"",[_.dt.required(),this._validation.isValidAbsolutePath()]],mountOptions:[t?.options||"",this._validation.matchesPattern(/^[a-zA-Z0-9= ]*$/,this.pageText.mountOptionsValidationText)],userNotes:[t?.comment||"",this._validation.isValidUserNote()],securityAccepted:[!1,u.kI.requiredTrue],unmountFilesystem:[""]})}_updateFilesystem(){return this._filesystemData={...this._filesystemData,host:this.currentFormData.hostnameOrIP,remotePath:this.currentFormData.exportPath,options:this.currentFormData.mountOptions,comment:this.currentFormData.userNotes},this._filesystemService.updateFilesystemConfiguration(this._filesystemData).pipe((0,T.x)((()=>{this._submitting=!1}))).subscribe({error:t=>{this._alertService.error(t)},complete:()=>{const t=this._locale.maketext("You have successfully mounted a network file system. You will be redirected in [quant,_1,second,seconds].",this._redirectDelaySeconds);this._handleSuccess(t,1e3*this._redirectDelaySeconds)}})}}return n.ɵfac=function(t){return new(t||n)(e.Y36(r.c9),e.Y36(w),e.Y36(u.qu),e.Y36(b),e.Y36(h.g),e.Y36(S),e.Y36(f.gz),e.Y36(f.F0),e.Y36(v),e.Y36(ce))},n.ɵcmp=e.Xpm({type:n,selectors:[["cp-cloud-configure-file-system"]],decls:3,vars:2,consts:[["loading",""],["id","configureFilesystemForm","name","configureFilesystemForm",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],[3,"id"],["id","configureFilesystemForm","name","configureFilesystemForm",3,"formGroup","ngSubmit"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"widget-title","pull-left","flip"],[1,"pull-right","flip"],["type","button","id","filesystemFormShowHideHelp","tabindex","1","autofocus","",1,"btn","btn-default","btn-xs","pull-right",3,"click"],["aria-hidden","true",1,"far","fa-question-circle","form-info-sign"],[1,"clearfix"],[1,"panel-body"],["idPrefix","hostnameOrIPFormField","labelFor","hostnameOrIPInput",3,"showAllHelp","showInfoToggle","control","labelText"],["field-label-help-text",""],["form-field-input-content",""],["type","text","id","hostnameOrIPInput","name","hostnameOrIPInput","formControlName","hostnameOrIP",1,"form-control"],["idPrefix","exportPathFormField","labelFor","exportPathInput",3,"showAllHelp","showInfoToggle","control","labelText"],["type","text","id","exportPathInput","name","exportPathInput","formControlName","exportPath",1,"form-control","removeMarginTop"],[3,"warning",4,"ngIf"],["idPrefix","mountOptionsFormField","labelFor","mountOptionsInput",3,"showAllHelp","showInfoToggle","control","labelText"],["field-label-help-text","",3,"innerHTML"],["type","text","id","mountOptionsInput","name","mountOptionsInput","formControlName","mountOptions",1,"form-control"],["idPrefix","userNotesFormField","labelFor","userNotesInput",3,"showAllHelp","showInfoToggle","control","labelText"],["id","userNotesInput","name","userNotesInput","formControlName","userNotes",1,"form-control"],["id","acceptSecurityCallout","calloutType","danger"],["callout-heading",""],[3,"innerHTML"],["type","checkbox","id","acceptSecurityInput","formControlName","securityAccepted"],["type","button","class","btn btn-default unmountFilesystemToggleBtn",3,"click",4,"ngIf"],["class","unmountFilesystemSection",4,"ngIf"],[1,"panel-footer"],["type","submit",3,"id","buttonClass","buttonState"],[3,"ngClass","href"],["aria-hidden","true",1,"fas",3,"ngClass"],[3,"warning"],["type","button",1,"btn","btn-default","unmountFilesystemToggleBtn",3,"click"],[1,"unmountFilesystemSection"],["idPrefix","unmountFilesystemFormField","labelForm","unmountFilesystemInput",3,"showAllHelp","showInfoToggle","control","labelText"],["id","unmountFilesystemHostInput","name","unmountFilesystemHostInput","formControlName","unmountFilesystem",1,"form-control"],["matchText",""],["type","button",1,"btn","btn-link",3,"click"],["aria-hidden","true",1,"fas","fa-copy"],[3,"id","buttonClass","buttonState","click"]],template:function(t,o){if(1&t&&(e.YNc(0,pe,1,1,"ng-template",null,0,e.W1O),e.YNc(2,_e,47,43,"form",1)),2&t){const i=e.MAs(1);e.xp6(2),e.Q6J("ngIf",o.filesystemFormGroup)("ngIfElse",i)}},directives:[r.go,c.O5,u._Y,u.JL,u.sg,r.hg,u.Fj,u.JJ,u.u,ue,r.Oc,u.Wl,r.xV,c.mk],styles:["figure[_ngcontent-%COMP%]{margin-bottom:var(--cp-spacer-2)}figure[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%], figure[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline}.unmountFilesystemToggleBtn[_ngcontent-%COMP%]{border:var(--cp-border-width-2) solid var(--cp-error-color);color:var(--cp-error-color)}.unmountFilesystemSection[_ngcontent-%COMP%]{border:var(--cp-border-width-2) solid var(--cp-error-color);padding:var(--cp-spacer-3)}.removeMarginTop[_ngcontent-%COMP%]{margin-top:var(--cp-spacer-0)}.panel-footer[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{margin-top:var(--cp-border-width-5)}"]}),n})();const xe=[{path:"cpsc-setup-steps",component:le},{path:"initial-filesystem-configuration",component:Z},{path:"manage-filesystem-configuration",component:Z,data:{filesystemPresent:!0}},{path:"",pathMatch:"full",redirectTo:"cpsc-setup-steps"},{path:"**",pathMatch:"full",redirectTo:"cpsc-setup-steps"}];let ye=(()=>{class n{}return n.ɵfac=function(t){return new(t||n)},n.ɵmod=e.oAB({type:n}),n.ɵinj=e.cJS({imports:[[f.Bz.forRoot(xe)],f.Bz]}),n})();function ve(n,s){1&n&&e.GkF(0)}function Te(n,s){1&n&&e.GkF(0)}function Ce(n,s){if(1&n&&(e.TgZ(0,"section",12)(1,"h3",13),e._uU(2),e.qZA(),e.TgZ(3,"ul",14)(4,"li")(5,"a",15),e._UZ(6,"i",16),e.TgZ(7,"span"),e._uU(8),e.qZA()()()()()),2&n){const t=s.$implicit,o=e.oxw();e.xp6(2),e.Oqu(o.locale.maketext("Need Help?")),e.xp6(3),e.MGl("id","linkAboutTheInterface",t,""),e.s9C("title",o.locale.maketext("Need help? Click here to read more about this interface.")),e.xp6(3),e.Oqu(o.locale.maketext("About this interface"))}}const be=function(){return{$implicit:"Mobile"}};let Se=(()=>{class n{constructor(t){this.locale=t,_.uZ.locale=this.locale}}return n.ɵfac=function(t){return new(t||n)(e.Y36(h.g))},n.ɵcmp=e.Xpm({type:n,selectors:[["cp-cloud-root"]],decls:15,vars:4,consts:[["position","top-right","id","cpscAlertList"],["id","content"],[1,"row"],[1,"col-xs-12","col-lg-10"],[1,"col-md-4","hidden-xs","hidden-sm","pull-right","sticky-resource-panel"],[1,"section"],[4,"ngTemplateOutlet"],[1,"col-xs-12","col-sm-12","col-md-8","pull-left"],["id","viewContent",1,"ng-cloak","section","animate-view"],[1,"col-xs-12","hidden-lg","hidden-md"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["resourceTemplate",""],[1,"widget"],[1,"widget-title"],[1,"resource-link-list"],["href","https://go.cpanel.net/whmdocsCPSC","target","whm_documentation",3,"id","title"],["aria-hidden","true",1,"fas","fa-fw","fa-external-link-alt"]],template:function(t,o){if(1&t&&(e._UZ(0,"cp-alert-list",0),e.TgZ(1,"div",1)(2,"div")(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),e.YNc(7,ve,1,0,"ng-container",6),e.qZA()(),e.TgZ(8,"div",7),e._UZ(9,"router-outlet",8),e.qZA(),e.TgZ(10,"div",9)(11,"div",5),e.YNc(12,Te,1,0,"ng-container",10),e.qZA()()()()()(),e.YNc(13,Ce,9,4,"ng-template",null,11,e.W1O)),2&t){const i=e.MAs(14);e.xp6(7),e.Q6J("ngTemplateOutlet",i),e.xp6(5),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.DdM(3,be))}},directives:[r.hF,c.tP,f.lC],encapsulation:2}),n})(),Fe=(()=>{class n{}return n.ɵfac=function(t){return new(t||n)},n.ɵmod=e.oAB({type:n,bootstrap:[Se]}),n.ɵinj=e.cJS({providers:[{provide:c.mr,useValue:H},{provide:Window,useValue:window},{provide:b,useValue:E},{provide:S,useValue:5},{provide:v,useValue:Y}],imports:[[r.zr,r.CQ,k.m,F.au,ye,x.b2,r.df,r.kx,r.zf,u.UX]]}),n})();(0,e.G48)(),x.q6().bootstrapModule(Fe).catch((n=>console.error(n)))}},g=>{g.O(0,[736],(()=>g(g.s=6257))),g.O()}]);
