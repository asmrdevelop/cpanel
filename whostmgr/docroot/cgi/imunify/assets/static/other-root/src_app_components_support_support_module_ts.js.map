{"version":3,"file":"src_app_components_support_support_module_ts.js","mappings":"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","sources":["./api/support.ts","./src/app/services/support.ts","./src/app/components/support/support.component.html","./src/app/components/support/support.component.ts","./src/app/utils/file-uploader/file-uploader.module.ts","./src/app/components/support/support.module.ts"],"sourcesContent":["import { RequestParams } from './misc';\n\n\nexport class SupportAPI {\n    static send(params: SupportSendRequest) {\n        return new RequestParams(['support', 'send'], params);\n    }\n}\n\nexport interface SupportSendRequest {\n    email: string;\n    subject: string;\n    description: string;\n    cln: string;\n    attachments?: string[];\n}\n","import { Injectable } from '@angular/core';\nimport { SupportAPI } from '@imunify360-api/support';\nimport { XHR } from 'app/utils/xhr/xhr';\n\n\n@Injectable()\nexport class SupportService {\n    constructor(public xhr: XHR) {}\n    send = this.xhr.rx(SupportAPI.send);\n}\n","<div class=\"card-container\">\n    <div *ngIf=\"ticketUrl === undefined; else successMessage\">\n        <i360-header>\n            <mat-icon class=\"support hidden-xs\" svgIcon=\"support\"></mat-icon>\n            {{ 'support.title' | translate }}\n        </i360-header>\n\n        <form class=\"card-container settings-container col-md-9\"\n              [formGroup]=\"form\" (i360Submit)=\"submit()\" [hidden]=\"ticketUrl\">\n            <div class=\"canvas\" i360Loader>\n                <div class=\"input_group\">\n                    <ng-container>\n                        <i360-settings-field inputTitle=\"{{ 'support.email.title' | translate }}\">\n                            <input type=\"text\"\n                                   class=\"underline-input\"\n                                   placeholder=\"{{ 'support.email.placeholder' | translate }}\"\n                                   formControlName=\"email\"\n                                   name=\"request[anonymous_requester_email]\"\n                                   autocomplete=\"email\">\n                        </i360-settings-field>\n                        <i360-settings-field inputTitle=\"{{ 'support.subject.title' | translate }}\">\n                            <input type=\"text\"\n                                   class=\"underline-input\"\n                                   placeholder=\"{{ 'support.subject.placeholder' | translate }}\"\n                                   formControlName=\"subject\">\n                        </i360-settings-field>\n                        <i360-settings-field inputTitle=\"{{ 'support.description.title' | translate }}\"\n                                             description=\"{{ 'support.description.description' | translate }}\">\n                            <textarea class=\"underline-input\"\n                                   placeholder=\"{{ 'support.description.placeholder' | translate }}\"\n                                   formControlName=\"description\"\n                                   autosize></textarea>\n                        </i360-settings-field>\n                        <i360-settings-field inputTitle=\"{{ 'support.cln.title' | translate }}\"\n                                             description=\"\">\n                            <input type=\"text\"\n                                   class=\"underline-input\"\n                                   placeholder=\"{{ 'support.cln.placeholder' | translate }}\"\n                                   formControlName=\"cln\"\n                                   name=\"request[custom_fields][43148369]\">\n                        </i360-settings-field>\n                        <i360-settings-field *ngIf=\"!panel.isNoPanel\" inputTitle=\"{{ 'support.attachments' | translate }}\">\n                            <i360-file-uploader formControlName=\"file\"></i360-file-uploader>\n                        </i360-settings-field>\n                        <i360-settings-field>\n                            <div class=\"tools\">\n                                <button id=\"support-submit\" color=\"primary\"  type=\"submit\" mat-raised-button [disabled]=\"submitted\">\n                                    {{ 'support.submit' | translate }}\n                                </button>\n                            </div>\n                        </i360-settings-field>\n                    </ng-container>\n                </div>\n            </div>\n        </form>\n    </div>\n\n    <ng-template #successMessage>\n        <div class=\"success-message\">\n            <img [src]=\"imagePath+'/dog.png'\">\n            <h3 translate>support.success.title</h3>\n            <h4 translate>support.success.subtitle</h4>\n            <div *ngIf=\"ticketUrl; else messageText\">\n                    <p translate>support.success.link</p>\n                    <a href=\"{{ ticketUrl }}\" target=\"_blank\">{{ ticketUrl }}</a>\n            </div>\n            <ng-template #messageText>\n                    <p translate class=\"i360-severity-text-medium\">support.success.checkEmail</p>\n            </ng-template>\n        </div>\n    </ng-template>\n\n</div>\n","import { ChangeDetectorRef, Component, OnDestroy, ViewChild } from '@angular/core';\nimport { FileService } from 'app/services/file';\nimport { I360Validators } from 'app/utils/validator/validators';\nimport { useLoader } from 'app/utils/loader/decorators';\nimport { LoaderDirective } from 'app/utils/loader/loader.directive';\nimport { getImagePath } from 'app/core/misc';\nimport { MAX_FILE_SIZE } from 'app/utils/file-uploader/file-uploader.component';\nimport { SupportService } from 'app/services/support';\nimport { I360FormBuilder } from 'app/utils/validator/form-builder';\nimport { switchMap, tap, firstValueFrom } from 'rxjs';\nimport { Panel } from 'app/utils/panel';\n\n\n@Component({\n    selector: 'support',\n    styleUrls: ['../settings/settings-index.component.scss', 'support.component.scss'],\n    templateUrl: 'support.component.html',\n    providers: [SupportService],\n})\nexport class SupportComponent implements OnDestroy {\n    public form = this.formBuilder.group({\n        email: this.formBuilder.control('',\n            [I360Validators.required('email'), I360Validators.email]),\n        subject: this.formBuilder.control('', I360Validators.required('subject')),\n        description: this.formBuilder.control('', I360Validators.required('description')),\n        cln: this.formBuilder.control(''),\n        file: this.formBuilder.control([],\n            [I360Validators.fileSize(MAX_FILE_SIZE), I360Validators.maxFiles(5)]),\n    });\n    public ticketUrl;\n    public submitted = false;\n    public imagePath: string = getImagePath();\n    @ViewChild(LoaderDirective, {static: false}) public loader: LoaderDirective;\n\n    public constructor(\n        private formBuilder: I360FormBuilder,\n        private fileService: FileService,\n        private supportService: SupportService,\n        public panel: Panel,\n        public detector: ChangeDetectorRef,\n    ) {}\n\n    @useLoader\n    async submit() {\n        this.submitted = true;\n        const {email, subject, description, cln, file} = this.form.value;\n        await firstValueFrom(this.fileService.upload(file).pipe(\n            switchMap((uploaded) => {\n                return this.supportService.send({\n                    email,\n                    subject,\n                    description,\n                    cln,\n                    ...(\n                        uploaded ? {attachments: [uploaded.data]} : {}\n                    ),\n                });\n            }),\n            tap(response => {\n                this.ticketUrl = response.data.items.pop();\n                this.form.reset();\n                this.detector.detectChanges();\n            }),\n        ), { defaultValue: undefined });\n        this.submitted = false;\n    }\n\n    ngOnDestroy(): void {\n        this.ticketUrl = '';\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FileUploaderComponent } from './file-uploader.component';\nimport { I360TranslateModule } from 'app/utils/translate/translate.module';\nimport { I360ModalModule } from 'app/utils/modals/modal.module';\n\n@NgModule({\n    imports: [CommonModule, I360TranslateModule, I360ModalModule],\n    declarations: [FileUploaderComponent],\n    exports: [FileUploaderComponent]\n})\nexport class FileUploaderModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { SupportComponent } from 'app/components/support/support.component';\nimport { FileUploaderModule } from 'app/utils/file-uploader/file-uploader.module';\nimport { I360TranslateModule } from 'app/utils/translate/translate.module';\nimport { I360ValidationModule } from 'app/utils/validator/validation.module';\nimport { I360LoaderModule } from 'app/utils/loader/loader.module';\nimport { I360SettingsModule } from 'app/components/settings/settings.module';\nimport { I360DescriptionModule } from 'app/utils/description/description.module';\nimport { I360TableModule } from 'app/utils/table/table.module';\nimport { MatIconModule } from '@angular/material/icon';\nimport { RouterModule } from '@angular/router';\n\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MatButtonModule,\n        MatTooltipModule,\n        MatIconModule,\n        I360ValidationModule,\n        I360TranslateModule,\n        I360LoaderModule,\n        I360SettingsModule,\n        I360DescriptionModule,\n        I360TableModule,\n        FileUploaderModule,\n        RouterModule.forChild([{\n            path: '',\n            component: SupportComponent,\n        }]),\n    ],\n    declarations: [SupportComponent],\n    exports: [SupportComponent],\n})\nexport class I360SupportModule { }\n"],"names":["SupportAPI","send","params","RequestParams","SupportService","constructor","xhr","this","rx","i0","i1","factory","ɵfac","_r5","ctx_r4","submit","SupportComponent_div_1_i360_settings_field_26_Template","ctx_r0","form","ticketUrl","panel","isNoPanel","submitted","ctx_r6","SupportComponent_ng_template_2_div_6_Template","SupportComponent_ng_template_2_ng_template_7_Template","ctx_r2","imagePath","_r7","SupportComponent","formBuilder","fileService","supportService","detector","group","email","control","I360Validators","subject","description","cln","file","MAX_FILE_SIZE","getImagePath","_this","_asyncToGenerator","value","firstValueFrom","upload","pipe","switchMap","uploaded","attachments","data","tap","response","items","pop","reset","detectChanges","defaultValue","undefined","ngOnDestroy","i2","i3","i4","selectors","viewQuery","rf","ctx","LoaderDirective","decls","vars","consts","template","SupportComponent_div_1_Template","SupportComponent_ng_template_2_Template","_r1","useLoader","FileUploaderModule","CommonModule","I360TranslateModule","I360ModalModule","I360SupportModule","MatButtonModule","MatTooltipModule","MatIconModule","I360ValidationModule","I360LoaderModule","I360SettingsModule","I360DescriptionModule","I360TableModule","RouterModule","path","component"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}